# Workflow builder canvas and persistence requirements

requirements:
  - id: BAS-WORKFLOW-PERSIST-CRUD
    category: workflow.builder
    prd_ref: "Functional Requirements > Must Have > Visual workflow builder"
    title: Workflows persist nodes, edges, and metadata
    description: |
      Validates compiler, database, and API layers so workflows round-trip with folder hierarchy
      and normalized metadata required for execution planning.
    status: complete
    criticality: P0
    validation:
      - type: test
        ref: api/browserless/compiler/compiler_test.go
        status: implemented
        notes: Ensures ordering, cycle detection, and unsupported node handling.
      - type: test
        ref: api/browserless/runtime/session_test.go
        status: implemented
        notes: Exercises Browserless session payloads without external dependencies.
      - type: test
        ref: api/database/repository_test.go
        status: implemented
        notes: Confirms workflow persistence and retrieval with folder hierarchy metadata.
      - type: test
        ref: test/phases/test-unit.sh
        status: implemented
        notes: Unit phase aggregates Go + Node coverage with thresholds enforced.

  - id: BAS-WORKFLOW-DEMO-SEED
    category: workflow.builder
    prd_ref: "Functional Requirements > Must Have > Visual workflow builder"
    title: Demo project and workflow seed remain available after boot
    description: |
      Guarantees the bundled demo project loads for first-time operators, providing an executable
      workflow that exercises the canvas and executor pipeline.
    status: pending
    criticality: P0
    validation:
      - type: automation
        ref: test/playbooks/projects/demo-sanity.yaml
        status: planned
        notes: Planned automation validates the seed project + workflow through the public API.
