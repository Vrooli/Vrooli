version: "1.0"
name: browserless-telemetry-smoke
summary: |
  Runs an instrumentation workflow (data URL site with scripted telemetry) that captures highlights,
  mask overlays, console logs, and network requests to verify the Browser Automation Studio replay
  pipeline end-to-end. Confirms assertion metadata, screenshot storage, timeline aggregation, and
  replay export packaging without relying on manual checks.
labels:
  - telemetry
  - replay
  - browserless
  - ci-smoke
  - ui-validation
owner: execution-team@vrooli.dev
prerequisites:
  - Browser Automation Studio scenario dependencies installed via `./scripts/manage.sh setup`
  - Browserless, Postgres, and MinIO resources available through the lifecycle system
  - `curl`, `jq`, and `vrooli` available on PATH
steps:
  - name: telemetry-smoke
    description: |
      Launches the scenario with clean state, provisions a highlight-rich workflow, executes it,
      and asserts that timeline frames include screenshot artifacts, highlight metadata, console
      logs, and network events before validating the replay export manifest.
    command: ./test/playbooks/executions/telemetry-smoke.sh
    timeout: 600
success_criteria:
  - type: log_scan
    description: The automation prints "ðŸŽ¯ Telemetry smoke check passed" when all validations succeed.
    pattern: "Telemetry smoke check passed"
    source: stdout
