{
  "module_id": "metrics",
  "title": "Metrics & Analytics",
  "priority": "P0",
  "description": "Event tracking, variant tagging, and analytics dashboard",
  "requirements": [
    {
      "id": "METRIC-TAG",
      "title": "Event variant tagging",
      "prd_ref": "OT-P0-019",
      "criticality": "P0",
      "description": "All events (page view, scroll, clicks, forms, conversions) include variant_id in payload",
      "validation": [
        {
          "type": "manual",
          "phase": "integration",
          "status": "not_implemented",
          "notes": "Placeholder - needs test implementation",
          "ref": "TBD",
          "_sync_metadata": {
            "last_test_run": "2025-11-21T13:30:56-05:00",
            "test_duration_ms": 0,
            "auto_updated": true,
            "test_names": [],
            "phase_result": "coverage/phase-results/integration.json",
            "source_phase": "integration",
            "tests_run": [
              "test/run-tests.sh"
            ]
          }
        }
      ],
      "status": "pending",
      "notes": "Event schema: {event_type, variant_id, variant_slug, timestamp, session_id, ...}",
      "_sync_metadata": {
        "last_updated": "2025-11-21T13:30:56-05:00",
        "updated_by": "auto-sync",
        "test_coverage_count": 0,
        "all_tests_passing": true,
        "phase_results": [
          "coverage/phase-results/integration.json"
        ],
        "tests_run": [
          "test/run-tests.sh"
        ]
      }
    },
    {
      "id": "METRIC-FILTER",
      "title": "Analytics variant filtering",
      "prd_ref": "OT-P0-020",
      "criticality": "P0",
      "description": "Admin analytics view filters stats by variant and time range",
      "validation": [
        {
          "type": "manual",
          "phase": "integration",
          "status": "not_implemented",
          "notes": "Placeholder - needs test implementation",
          "ref": "TBD",
          "_sync_metadata": {
            "last_test_run": "2025-11-21T13:30:56-05:00",
            "test_duration_ms": 0,
            "auto_updated": true,
            "test_names": [],
            "phase_result": "coverage/phase-results/integration.json",
            "source_phase": "integration",
            "tests_run": [
              "test/run-tests.sh"
            ]
          }
        }
      ],
      "status": "pending",
      "dependencies": [
        "METRIC-TAG"
      ],
      "notes": "UI: dropdown for variant selection, date range picker (today, 7d, 30d, custom)",
      "_sync_metadata": {
        "last_updated": "2025-11-21T13:30:56-05:00",
        "updated_by": "auto-sync",
        "test_coverage_count": 0,
        "all_tests_passing": true,
        "phase_results": [
          "coverage/phase-results/integration.json"
        ],
        "tests_run": [
          "test/run-tests.sh"
        ]
      }
    },
    {
      "id": "METRIC-EVENTS",
      "title": "Minimum event coverage",
      "prd_ref": "OT-P0-021",
      "criticality": "P0",
      "description": "System emits events for: page_view, scroll_depth (bands), click (element ID), form_submit, conversion (Stripe success)",
      "validation": [
        {
          "type": "manual",
          "phase": "integration",
          "status": "not_implemented",
          "notes": "Placeholder - needs test implementation",
          "ref": "TBD",
          "_sync_metadata": {
            "last_test_run": "2025-11-21T13:30:56-05:00",
            "test_duration_ms": 0,
            "auto_updated": true,
            "test_names": [],
            "phase_result": "coverage/phase-results/integration.json",
            "source_phase": "integration",
            "tests_run": [
              "test/run-tests.sh"
            ]
          }
        }
      ],
      "status": "pending",
      "notes": "Scroll depth bands: 25%, 50%, 75%, 100%; Click: element ID or data-track-id",
      "_sync_metadata": {
        "last_updated": "2025-11-21T13:30:56-05:00",
        "updated_by": "auto-sync",
        "test_coverage_count": 0,
        "all_tests_passing": true,
        "phase_results": [
          "coverage/phase-results/integration.json"
        ],
        "tests_run": [
          "test/run-tests.sh"
        ]
      }
    },
    {
      "id": "METRIC-IDEMPOTENT",
      "title": "Metrics idempotency",
      "prd_ref": "OT-P0-022",
      "criticality": "P0",
      "description": "Metrics ingestion is idempotent or deduplicated to avoid double-counting on retries",
      "validation": [
        {
          "type": "manual",
          "phase": "integration",
          "status": "not_implemented",
          "notes": "Placeholder - needs test implementation",
          "ref": "TBD",
          "_sync_metadata": {
            "last_test_run": "2025-11-21T13:30:56-05:00",
            "test_duration_ms": 0,
            "auto_updated": true,
            "test_names": [],
            "phase_result": "coverage/phase-results/integration.json",
            "source_phase": "integration",
            "tests_run": [
              "test/run-tests.sh"
            ]
          }
        }
      ],
      "status": "pending",
      "dependencies": [
        "METRIC-EVENTS"
      ],
      "notes": "Use unique event_id or (session_id + event_type + timestamp) composite key",
      "_sync_metadata": {
        "last_updated": "2025-11-21T13:30:56-05:00",
        "updated_by": "auto-sync",
        "test_coverage_count": 0,
        "all_tests_passing": true,
        "phase_results": [
          "coverage/phase-results/integration.json"
        ],
        "tests_run": [
          "test/run-tests.sh"
        ]
      }
    },
    {
      "id": "METRIC-SUMMARY",
      "title": "Analytics summary",
      "prd_ref": "OT-P0-023",
      "criticality": "P0",
      "description": "Analytics home shows total visitors, conversion rate per variant, top CTAs by CTR",
      "validation": [
        {
          "type": "manual",
          "phase": "integration",
          "status": "not_implemented",
          "notes": "Placeholder - needs test implementation",
          "ref": "TBD",
          "_sync_metadata": {
            "last_test_run": "2025-11-21T13:30:56-05:00",
            "test_duration_ms": 0,
            "auto_updated": true,
            "test_names": [],
            "phase_result": "coverage/phase-results/integration.json",
            "source_phase": "integration",
            "tests_run": [
              "test/run-tests.sh"
            ]
          }
        }
      ],
      "status": "pending",
      "dependencies": [
        "METRIC-TAG",
        "METRIC-EVENTS"
      ],
      "notes": "Summary cards: Total Visitors, Conversion Rate, Top CTA (by click-through rate)",
      "_sync_metadata": {
        "last_updated": "2025-11-21T13:30:56-05:00",
        "updated_by": "auto-sync",
        "test_coverage_count": 0,
        "all_tests_passing": true,
        "phase_results": [
          "coverage/phase-results/integration.json"
        ],
        "tests_run": [
          "test/run-tests.sh"
        ]
      }
    },
    {
      "id": "METRIC-DETAIL",
      "title": "Variant detail view",
      "prd_ref": "OT-P0-024",
      "criticality": "P0",
      "description": "Variant detail page shows views, CTA clicks, conversions, conversion rate, basic trend",
      "validation": [
        {
          "type": "manual",
          "phase": "integration",
          "status": "not_implemented",
          "notes": "Placeholder - needs test implementation",
          "ref": "TBD",
          "_sync_metadata": {
            "last_test_run": "2025-11-21T13:30:56-05:00",
            "test_duration_ms": 0,
            "auto_updated": true,
            "test_names": [],
            "phase_result": "coverage/phase-results/integration.json",
            "source_phase": "integration",
            "tests_run": [
              "test/run-tests.sh"
            ]
          }
        }
      ],
      "status": "pending",
      "dependencies": [
        "METRIC-SUMMARY"
      ],
      "notes": "Detail view: line chart (7d trend), KPI cards (views, clicks, conversions, rate)",
      "_sync_metadata": {
        "last_updated": "2025-11-21T13:30:56-05:00",
        "updated_by": "auto-sync",
        "test_coverage_count": 0,
        "all_tests_passing": true,
        "phase_results": [
          "coverage/phase-results/integration.json"
        ],
        "tests_run": [
          "test/run-tests.sh"
        ]
      }
    }
  ],
  "_metadata": {
    "last_synced_at": "2025-11-21T18:31:05.586Z"
  }
}
