{
  "metadata": {
    "description": "Validates UI-based scenario promotion from staging (generated/) to production (scenarios/) without requiring terminal/file operations",
    "requirements": ["TMPL-PROMOTION"],
    "reset": "none",
    "executionTimeoutMs": 90000
  },
  "settings": {
    "executionViewport": {
      "width": 1440,
      "height": 900,
      "preset": "desktop"
    }
  },
  "nodes": [
    {
      "id": "navigate-factory",
      "type": "navigate",
      "data": {
        "label": "Navigate to landing-manager factory UI",
        "destinationType": "scenario",
        "scenario": "landing-manager",
        "scenarioPath": "/",
        "waitUntil": "networkidle",
        "timeoutMs": 30000
      }
    },
    {
      "id": "wait-for-form",
      "type": "wait",
      "data": {
        "label": "Wait for generation form to load",
        "selector": "@selector/generation-form",
        "timeoutMs": 15000,
        "waitForMs": 500,
        "waitType": "element"
      }
    },
    {
      "id": "fill-name",
      "type": "type",
      "data": {
        "label": "Fill in scenario name for promotion test",
        "selector": "@selector/generation-name-input",
        "text": "Promotion Test",
        "clearFirst": true,
        "timeoutMs": 5000
      }
    },
    {
      "id": "wait-after-name",
      "type": "wait",
      "data": {
        "label": "Wait for slug auto-generation",
        "waitType": "time",
        "durationMs": 500
      }
    },
    {
      "id": "click-generate",
      "type": "click",
      "data": {
        "label": "Click generate button to create test scenario",
        "selector": "@selector/generate-button",
        "timeoutMs": 5000
      }
    },
    {
      "id": "wait-for-generation",
      "type": "wait",
      "data": {
        "label": "Wait for scenario generation to complete",
        "waitType": "time",
        "durationMs": 8000
      }
    },
    {
      "id": "wait-for-generated-list",
      "type": "wait",
      "data": {
        "label": "Wait for generated scenarios list to appear",
        "selector": "@selector/generated-scenarios-list",
        "timeoutMs": 15000,
        "waitForMs": 500,
        "waitType": "element"
      }
    },
    {
      "id": "assert-promote-button-exists",
      "type": "assert",
      "data": {
        "label": "Assert promote button is present for stopped promotion-test scenario",
        "selector": "@selector/lifecyclePromoteButton(scenarioId=promotion-test)",
        "assertMode": "exists",
        "timeoutMs": 5000,
        "failureMessage": "Promote button should be visible for stopped scenarios"
      }
    },
    {
      "id": "click-promote",
      "type": "click",
      "data": {
        "label": "Click promote to production button",
        "selector": "@selector/lifecyclePromoteButton(scenarioId=promotion-test)",
        "timeoutMs": 5000
      }
    },
    {
      "id": "wait-for-confirmation",
      "type": "wait",
      "data": {
        "label": "Wait for promotion confirmation",
        "waitType": "time",
        "durationMs": 2000
      }
    },
    {
      "id": "assert-promotion-result",
      "type": "assert",
      "data": {
        "label": "Assert promotion completed (button no longer visible or success message shown)",
        "selector": "@selector/generated-scenarios-list",
        "assertMode": "exists",
        "timeoutMs": 10000,
        "failureMessage": "Generated scenarios list should still be present after promotion"
      }
    }
  ],
  "edges": [
    { "id": "edge-0-1", "source": "navigate-factory", "target": "wait-for-form", "type": "smoothstep" },
    { "id": "edge-0-2", "source": "wait-for-form", "target": "fill-name", "type": "smoothstep" },
    { "id": "edge-0-3", "source": "fill-name", "target": "wait-after-name", "type": "smoothstep" },
    { "id": "edge-0-4", "source": "wait-after-name", "target": "click-generate", "type": "smoothstep" },
    { "id": "edge-0-5", "source": "click-generate", "target": "wait-for-generation", "type": "smoothstep" },
    { "id": "edge-1", "source": "wait-for-generation", "target": "wait-for-generated-list", "type": "smoothstep" },
    { "id": "edge-2", "source": "wait-for-generated-list", "target": "assert-promote-button-exists", "type": "smoothstep" },
    { "id": "edge-3", "source": "assert-promote-button-exists", "target": "click-promote", "type": "smoothstep" },
    { "id": "edge-4", "source": "click-promote", "target": "wait-for-confirmation", "type": "smoothstep" },
    { "id": "edge-5", "source": "wait-for-confirmation", "target": "assert-promotion-result", "type": "smoothstep" }
  ]
}
