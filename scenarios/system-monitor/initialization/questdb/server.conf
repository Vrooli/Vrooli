# QuestDB Configuration for System Monitor
# Time-series database for storing system metrics

# HTTP server configuration
http.enabled=true
http.bind.to=0.0.0.0:${PORT_QUESTDB}
http.net.connection.limit=256
http.net.connection.timeout=300000

# PostgreSQL wire protocol (for compatibility)
pg.enabled=true
pg.bind.to=0.0.0.0:8812
pg.net.connection.limit=10

# InfluxDB line protocol (for metrics ingestion)
line.tcp.enabled=true
line.tcp.bind.to=0.0.0.0:9009
line.tcp.connection.limit=256

# Query execution
query.timeout.sec=60
http.text.max.query.response.rows=1000000

# Storage configuration
cairo.sql.column.pool.capacity=4096
cairo.sql.compact.map.load.factor=0.7
cairo.sql.sort.key.max.pages=2097152

# WAL (Write-Ahead Log) configuration
wal.enabled.default=true
wal.segment.rollover.row.count=200000

# Metrics retention (automatic cleanup)
cairo.sql.backup.root=/var/lib/questdb/backup
cairo.wal.enabled.default=true

# System metrics table schema (auto-created)
# CREATE TABLE IF NOT EXISTS system_metrics (
#   timestamp TIMESTAMP,
#   cpu_usage DOUBLE,
#   memory_usage DOUBLE,
#   memory_total LONG,
#   disk_usage DOUBLE,
#   network_rx_bytes LONG,
#   network_tx_bytes LONG,
#   tcp_connections INT,
#   process_count INT,
#   load_avg DOUBLE,
#   hostname STRING
# ) timestamp(timestamp) PARTITION BY DAY;

# Performance tuning for system monitoring
cairo.sql.window.max.recursion=128
cairo.sql.join.context.pool.capacity=1024
http.json.cache.limit=16384
http.json.cache.timeout=5000

# Security (basic)
http.security.readonly=false
http.security.interrupt.on.closed.connection=true

# Logging
log.w.level=INFO
log.w.file.location=/var/log/questdb/stdout-%Y-%m-%d.log