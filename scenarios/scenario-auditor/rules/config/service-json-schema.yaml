---
- id: config-service-json-exists
  name: "Service JSON File Exists"
  description: "Ensures that .vrooli/service.json file exists in the scenario"
  category: config
  severity: critical
  enabled: true
  condition:
    type: file_exists
    target: ".vrooli/service.json"
  message: "Missing required .vrooli/service.json file"
  fix:
    type: file_create
    action: create
    target: ".vrooli/service.json"
    template: "service-json-template"
    description: "Create service.json file from template"
  tags:
    - service-json
    - configuration
    - required
  version: "1.0.0"

- id: config-service-json-schema-reference
  name: "Service JSON Schema Reference"
  description: "Ensures service.json file references the correct schema"
  category: config
  severity: high
  enabled: true
  condition:
    type: json_schema
    target: ".vrooli/service.json"
    path: "$schema"
    operator: contains
    value: ".vrooli/schemas/service.schema.json"
  message: "service.json must reference the correct schema: ../../../.vrooli/schemas/service.schema.json"
  fix:
    type: json_update
    action: update
    target: ".vrooli/service.json"
    path: "$schema"
    value: "../../../.vrooli/schemas/service.schema.json"
    description: "Update schema reference to correct path"
  tags:
    - service-json
    - schema
    - validation
  version: "1.0.0"

- id: config-service-json-version
  name: "Service JSON Version"
  description: "Ensures service.json has correct version format"
  category: config
  severity: medium
  enabled: true
  condition:
    type: json_schema
    target: ".vrooli/service.json"
    path: "version"
    operator: matches
    pattern: "^\\d+\\.\\d+\\.\\d+$"
  message: "service.json version must follow semantic versioning (e.g., '2.0.0')"
  fix:
    type: json_update
    action: update
    target: ".vrooli/service.json"
    path: "version"
    value: "2.0.0"
    description: "Update to semantic version format"
  tags:
    - service-json
    - versioning
  version: "1.0.0"

- id: config-service-name-consistency
  name: "Service Name Consistency"
  description: "Ensures service.name matches the scenario directory name"
  category: config
  severity: high
  enabled: true
  condition:
    type: json_schema
    target: ".vrooli/service.json"
    path: "service.name"
    operator: equals_directory_name
  message: "service.name must match the scenario directory name exactly"
  fix:
    type: json_update
    action: update
    target: ".vrooli/service.json"
    path: "service.name"
    value: "${SCENARIO_NAME}"
    description: "Update service name to match directory"
  tags:
    - service-json
    - naming
    - consistency
  version: "1.0.0"