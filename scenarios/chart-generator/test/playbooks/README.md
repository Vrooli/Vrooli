# Chart Generator Test Playbooks

This directory contains browser automation playbooks for end-to-end testing of the Chart Generator UI.

## Structure

```
playbooks/
├── capabilities/          # Feature-specific test workflows
│   ├── 01-core-charts/   # Core chart type generation (CHART-P0-001)
│   ├── 02-data-ingestion/ # Data input and validation
│   ├── 03-styling/       # Chart styling and themes (CHART-P0-003)
│   ├── 04-cli-interface/ # CLI integration validation
│   ├── 05-export/        # Chart export functionality (CHART-P0-005)
│   ├── 06-persistence/   # Database persistence validation
│   └── 07-ui-management/ # UI functionality (CHART-P0-007)
├── journeys/             # End-to-end user scenarios
├── __seeds/              # Database seed scripts for tests
├── __subflows/           # Reusable workflow fragments
├── registry.json         # Auto-generated playbook manifest
└── README.md            # This file
```

## Running Playbooks

Playbooks are executed during the `integration` phase of the test suite:

```bash
# Run all tests (includes playbook execution)
make test

# Run only integration tests
test/phases/test-integration.sh
```

## Registry Management

The `registry.json` file is auto-generated by the build script:

```bash
# Regenerate registry
node scripts/scenarios/testing/playbooks/build-registry.mjs --scenario /home/matthalloran8/Vrooli/scenarios/chart-generator
```

**Note**: The registry is automatically regenerated when running `make test`.

## Adding New Playbooks

1. Create a JSON file in the appropriate `capabilities/<module>/` directory
2. Follow the naming convention: `<feature>-<action>.json`
3. Include `requirements` array with relevant requirement IDs
4. Ensure selectors match those defined in `ui/src/consts/selectors.ts`
5. Run the registry build script to update `registry.json`

## Playbook Format

```json
{
  "description": "Brief description of what this playbook validates",
  "requirements": ["CHART-REQ-ID"],
  "steps": [
    {
      "type": "navigate|click|wait|assert|...",
      "...": "action-specific properties"
    }
  ],
  "cleanup": [],
  "fixtures": [],
  "reset": "none|soft|full"
}
```

## Test Selectors

All UI test selectors are centrally defined in:
- `ui/src/consts/selectors.ts`

This ensures consistency between UI components and automation tests.

## Requirement Coverage

Playbooks validate requirements through automated UI workflows:
- **Unit tests**: Validate API logic and data processing
- **CLI tests**: Validate command-line interface
- **Playbooks**: Validate UI workflows and integration
- **Lighthouse**: Validate performance and accessibility

Each requirement should have validation across multiple layers for comprehensive coverage.
