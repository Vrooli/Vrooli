version: 1.0
scenario: scenario-surfer

# Structure validation - files and directories that MUST exist:
structure:
  required_files:
    - .vrooli/service.json
    - PRD.md
    - README.md
    - api/main.go
    - api/go.mod
    - cli/scenario-surfer
    - cli/install.sh
    - ui/index.html
    - ui/app.js
    - ui/styles.css
    - ui/server.js
    - ui/package.json
    - scenario-test.yaml
    
  required_dirs:
    - api
    - cli  
    - ui
    - initialization
    - test

# Resource validation:
resources:
  optional: ["app-issue-tracker", "browserless"]
  health_timeout: 60

# Declarative tests:
tests:
  # API endpoint tests:
  - name: "API health check responds"
    type: http
    service: api
    endpoint: /health
    method: GET
    expect:
      status: 200
      body:
        status: "healthy"
        service: "scenario-surfer"
        
  - name: "Scenario discovery endpoint works"
    type: http
    service: api
    endpoint: /api/v1/scenarios/healthy
    method: GET
    expect:
      status: 200
      body:
        scenarios: []  # Array (may be empty if no scenarios running)
        categories: [] # Array (may be empty)
        
  - name: "UI serves main page"
    type: http
    service: ui
    endpoint: /
    method: GET
    expect:
      status: 200
      
  - name: "UI health check responds"
    type: http
    service: ui
    endpoint: /health
    method: GET
    expect:
      status: 200
      body:
        status: "healthy"
        service: "scenario-surfer-ui"
        
  # CLI command tests:
  - name: "CLI status command works"
    type: exec
    command: ./cli/scenario-surfer status --json
    expect:
      exit_code: 0
      output_contains: ["status"]
      
  - name: "CLI help command works"
    type: exec
    command: ./cli/scenario-surfer help
    expect:
      exit_code: 0
      output_contains: ["Scenario Surfer", "USAGE"]
      
  - name: "CLI version command works"
    type: exec
    command: ./cli/scenario-surfer version
    expect:
      exit_code: 0
      output_contains: ["Scenario Surfer v1.0.0"]