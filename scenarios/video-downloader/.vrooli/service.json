{
  "$schema": "../../../.vrooli/schemas/service.schema.json",
  "version": "1.0.0",
  "service": {
    "parent": "vrooli",
    "name": "video-downloader",
    "displayName": "Video Downloader",
    "description": "Smart media retrieval tool for downloading videos from various platforms",
    "version": "1.0.0",
    "tags": [
      "saas-application",
      "media",
      "video",
      "download",
      "youtube",
      "converter",
      "javascript-ui",
      "go-api"
    ]
  },
  "ports": {
    "api": {
      "env_var": "SERVICE_PORT",
      "range": "31500-31749",
      "fallback": "auto",
      "description": "Video Downloader API port"
    },
    "ui": {
      "env_var": "UI_PORT",
      "range": "38000-38249",
      "fallback": "auto",
      "description": "Video Downloader UI port"
    }
  },
  "components": {
    "api": {
      "enabled": true,
      "language": "go",
      "path": "api",
      "main": "main.go"
    },
    "ui": {
      "enabled": true,
      "framework": "javascript",
      "path": "ui",
      "main": "server.js"
    },
    "cli": {
      "enabled": true,
      "language": "bash",
      "path": "cli",
      "command": "video-downloader"
    }
  },
  "resources": {
    "postgres": {
      "enabled": true,
      "required": true
    },
    "redis": {
      "enabled": true,
      "required": true
    },
    "n8n": {
      "enabled": true,
      "required": true
    },
    "browserless": {
      "enabled": true,
      "required": false
    }
  },
  "initialization": {
    "postgres": [
      {
        "file": "initialization/postgres/schema.sql",
        "type": "schema"
      }
    ],
    "n8n": [
      {
        "name": "video-processor",
        "file": "initialization/n8n/video-processor.json",
        "active": true
      },
      {
        "name": "url-analyzer",
        "file": "initialization/n8n/url-analyzer.json",
        "active": true
      },
      {
        "name": "download-orchestrator",
        "file": "initialization/n8n/download-orchestrator.json",
        "active": true
      }
    ]
  },
  "dependencies": {
    "system": [
      "yt-dlp",
      "ffmpeg"
    ],
    "shared_workflows": [
      "rate-limiter"
    ]
  },
  "healthcheck": {
    "enabled": true,
    "interval": 30,
    "timeout": 10,
    "retries": 3,
    "endpoints": [
      {
        "type": "http",
        "url": "http://localhost:${SERVICE_PORT}/health",
        "method": "GET",
        "expected_status": 200
      }
    ]
  },
  "logging": {
    "level": "info",
    "format": "json",
    "output": "stdout"
  },
  "lifecycle": {
    "setup": {
      "description": null,
      "condition": {
        "checks": [
          {
            "type": "binaries",
            "targets": [
              "api/video-downloader-api"
            ]
          },
          {
            "type": "cli",
            "command": "video-downloader"
          },
          {
            "type": "dependencies",
            "paths": [
              "ui/package.json"
            ]
          },
          {
            "type": "resources",
            "populated": true
          }
        ]
      },
      "steps": null
    }
  }
}
