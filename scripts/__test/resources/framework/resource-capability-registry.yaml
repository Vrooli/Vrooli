# ====================================================================
# Vrooli Resource Capability Registry
# ====================================================================
#
# Defines the required and optional capabilities for each resource category.
# This registry is used by the testing framework to validate that resources
# implement the expected functionality for their category.
#
# Usage:
#   - Required capabilities MUST be implemented by all resources in category
#   - Optional capabilities are nice-to-have but not mandatory
#   - Testing framework uses this to generate category-specific tests
#
# ====================================================================

version: "1.0"
registry_name: "Vrooli Resource Capability Registry"
last_updated: "2025-01-02"

categories:
  ai:
    description: "AI and machine learning resources for inference, training, and processing"
    required_capabilities:
      - name: "model_management"
        description: "Ability to list, load, and manage AI models"
        test_method: "api_endpoint"
        endpoint: "/api/models"
        validation: "json_response_with_models_array"
      
      - name: "inference"
        description: "Core AI inference capability"
        test_method: "api_endpoint" 
        endpoint: "/api/inference"
        validation: "accepts_prompt_returns_response"
        
      - name: "health_monitoring"
        description: "Detailed health status including model availability"
        test_method: "manage_script"
        action: "health-detailed"
        validation: "returns_model_and_capability_info"
    
    optional_capabilities:
      - name: "fine_tuning"
        description: "Model fine-tuning and customization"
        test_method: "api_endpoint"
        endpoint: "/api/fine-tune"
        
      - name: "batch_processing"
        description: "Batch inference processing"
        test_method: "api_endpoint" 
        endpoint: "/api/batch"
        
      - name: "embedding_generation"
        description: "Text/data embedding generation"
        test_method: "api_endpoint"
        endpoint: "/api/embeddings"
        
      - name: "model_serving"
        description: "Dynamic model loading/unloading"
        test_method: "manage_script"
        action: "model-load"
        
      - name: "performance_benchmarking"
        description: "Built-in performance testing"
        test_method: "manage_script"
        action: "benchmark"

  storage:
    description: "Data storage and persistence resources"
    required_capabilities:
      - name: "data_persistence"
        description: "Reliable data storage and retrieval"
        test_method: "functional_test"
        validation: "write_read_verify_cycle"
        
      - name: "health_monitoring"
        description: "Storage health with capacity and performance metrics"
        test_method: "manage_script"
        action: "health-detailed"
        validation: "returns_storage_metrics"
        
      - name: "statistics_reporting"
        description: "Storage usage and performance statistics"
        test_method: "manage_script"
        action: "stats"
        validation: "returns_usage_statistics"
    
    optional_capabilities:
      - name: "backup_restore"
        description: "Data backup and restoration"
        test_method: "manage_script"
        action: "backup"
        
      - name: "replication"
        description: "Data replication for high availability"
        test_method: "manage_script"
        action: "replication-status"
        
      - name: "encryption"
        description: "Data encryption at rest and in transit"
        test_method: "configuration_check"
        validation: "encryption_enabled"
        
      - name: "migration"
        description: "Data migration between versions"
        test_method: "manage_script"
        action: "migrate"
        
      - name: "vacuum_optimization"
        description: "Storage optimization and cleanup"
        test_method: "manage_script"
        action: "vacuum"

  automation:
    description: "Workflow automation and orchestration platforms"
    required_capabilities:
      - name: "web_interface"
        description: "Responsive web-based user interface"
        test_method: "http_endpoint"
        endpoint: "/"
        validation: "ui_loads_within_5_seconds"
        
      - name: "workflow_management"
        description: "Create, edit, and manage workflows"
        test_method: "api_endpoint"
        endpoint: "/api/workflows"
        validation: "workflow_crud_operations"
        
      - name: "health_monitoring"
        description: "Platform health with workflow metrics"
        test_method: "manage_script"
        action: "health-detailed"
        validation: "returns_workflow_status"
        
      - name: "ui_status"
        description: "Web UI availability and responsiveness"
        test_method: "manage_script"
        action: "ui-status"
        validation: "confirms_ui_accessibility"
    
    optional_capabilities:
      - name: "webhook_triggers"
        description: "HTTP webhook trigger support"
        test_method: "api_endpoint"
        endpoint: "/webhook/test"
        
      - name: "scheduled_execution"
        description: "Cron-style scheduled workflow execution"
        test_method: "feature_detection"
        validation: "schedule_configuration_available"
        
      - name: "external_integrations"
        description: "Third-party service integrations"
        test_method: "feature_detection"
        validation: "integration_catalog_available"
        
      - name: "workflow_import_export"
        description: "Workflow definition import/export"
        test_method: "manage_script"
        action: "workflow-export"
        
      - name: "real_time_monitoring"
        description: "Live workflow execution monitoring"
        test_method: "api_endpoint"
        endpoint: "/api/executions"

  agents:
    description: "Autonomous agents for system interaction and automation"
    required_capabilities:
      - name: "core_automation"
        description: "Basic automation capabilities"
        test_method: "manage_script"
        action: "capability-test"
        validation: "demonstrates_automation_ability"
        
      - name: "health_monitoring"
        description: "Agent health with capability status"
        test_method: "manage_script"
        action: "health-detailed"
        validation: "returns_capability_status"
        
      - name: "session_management"
        description: "Agent session lifecycle management"
        test_method: "manage_script"
        action: "session-status"
        validation: "reports_session_state"
    
    optional_capabilities:
      - name: "screen_interaction"
        description: "Desktop screen capture and interaction"
        test_method: "manage_script"
        action: "screen-test"
        
      - name: "web_automation"
        description: "Web browser automation"
        test_method: "api_endpoint"
        endpoint: "/api/browser"
        
      - name: "security_sandboxing"
        description: "Secure execution environment"
        test_method: "manage_script"
        action: "security-check"
        
      - name: "visual_reasoning"
        description: "AI-powered visual understanding"
        test_method: "feature_detection"
        validation: "vision_model_available"
        
      - name: "multi_modal_input"
        description: "Support for text, voice, and visual input"
        test_method: "feature_detection"
        validation: "multiple_input_types_supported"

  search:
    description: "Information retrieval and search capabilities"
    required_capabilities:
      - name: "query_processing"
        description: "Basic search query processing"
        test_method: "manage_script"
        action: "query-test"
        validation: "processes_search_queries"
        
      - name: "health_monitoring" 
        description: "Search service health with index information"
        test_method: "manage_script"
        action: "health-detailed"
        validation: "returns_search_metrics"
        
      - name: "results_formatting"
        description: "Structured search result formatting"
        test_method: "api_endpoint"
        endpoint: "/search?q=test&format=json"
        validation: "returns_structured_results"
    
    optional_capabilities:
      - name: "privacy_protection"
        description: "Privacy-respecting search without tracking"
        test_method: "manage_script"
        action: "privacy-check"
        
      - name: "multiple_sources"
        description: "Aggregated results from multiple sources"
        test_method: "feature_detection"
        validation: "metasearch_capability"
        
      - name: "advanced_filtering"
        description: "Advanced search filters and operators"
        test_method: "api_endpoint"
        endpoint: "/search?q=test&category=images"
        
      - name: "index_management"
        description: "Search index management and statistics"
        test_method: "manage_script"
        action: "index-stats"
        
      - name: "performance_optimization"
        description: "Query performance optimization"
        test_method: "performance_test"
        validation: "response_time_under_2_seconds"

  execution:
    description: "Code execution and sandboxing environments"
    required_capabilities:
      - name: "code_execution"
        description: "Secure code execution capability"
        test_method: "manage_script"
        action: "execute-test"
        validation: "executes_safe_code"
        
      - name: "language_support"
        description: "Multiple programming language support"
        test_method: "api_endpoint"
        endpoint: "/api/languages"
        validation: "lists_supported_languages"
        
      - name: "health_monitoring"
        description: "Execution environment health with metrics"
        test_method: "manage_script"
        action: "health-detailed"
        validation: "returns_execution_metrics"
    
    optional_capabilities:
      - name: "timeout_management"
        description: "Execution timeout and resource limits"
        test_method: "configuration_check"
        validation: "timeout_limits_configured"
        
      - name: "memory_limits"
        description: "Memory usage limits and monitoring"
        test_method: "configuration_check"
        validation: "memory_limits_configured"
        
      - name: "security_sandboxing"
        description: "Secure execution sandbox"
        test_method: "manage_script"
        action: "security-check"
        
      - name: "dependency_management"
        description: "Package and dependency installation"
        test_method: "feature_detection"
        validation: "package_manager_available"
        
      - name: "result_persistence"
        description: "Execution result storage and retrieval"
        test_method: "api_endpoint"
        endpoint: "/api/results"

# Resource-specific capability mappings
resource_mappings:
  ollama:
    category: "ai"
    additional_capabilities:
      - "model_quantization"
      - "gpu_acceleration"
      - "streaming_responses"
      
  whisper:
    category: "ai"
    additional_capabilities:
      - "multi_language_support"
      - "audio_format_detection"
      - "confidence_scoring"
      
  postgres:
    category: "storage"
    additional_capabilities:
      - "acid_transactions"
      - "sql_compliance"
      - "connection_pooling"
      
  redis:
    category: "storage"
    additional_capabilities:
      - "pub_sub_messaging"
      - "lua_scripting"
      - "clustering"
      
  n8n:
    category: "automation"
    additional_capabilities:
      - "visual_workflow_editor"
      - "300_plus_integrations"
      - "conditional_logic"
      
  agent-s2:
    category: "agents"
    additional_capabilities:
      - "desktop_environment_interaction"
      - "ai_powered_navigation"
      - "cross_platform_support"

# Validation rules
validation_rules:
  response_time_limits:
    ai_inference: "30_seconds"
    storage_query: "5_seconds"
    automation_ui_load: "5_seconds"
    agent_action: "10_seconds"
    search_query: "10_seconds"
    code_execution: "60_seconds"
    
  reliability_requirements:
    uptime_percentage: 95.0
    error_rate_threshold: 5.0
    recovery_time_max: "30_seconds"
    
  security_requirements:
    - "no_plain_text_secrets"
    - "secure_default_configurations"
    - "input_validation"
    - "output_sanitization"
    - "resource_isolation"