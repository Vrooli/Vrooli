{
  "scenario": {
    "name": "Automated Web Research Pipeline",
    "description": "Automated web research using Agent S2 and Browserless with AI analysis",
    "public": false,
    "source_url": null
  },
  "agents": [
    {
      "type": "Agents::TriggerAgent",
      "name": "Research Trigger",
      "schedule": "never",
      "options": {
        "rules": [
          {
            "type": "field==value",
            "path": "action",
            "value": "start_research"
          }
        ]
      },
      "propagate_immediately": true
    },
    {
      "type": "Agents::PostAgent",
      "name": "Browserless Screenshot",
      "schedule": "never",
      "options": {
        "post_url": "http://localhost:4110/screenshot",
        "expected_receive_period_in_days": 1,
        "method": "post",
        "content_type": "json",
        "payload": {
          "url": "{{target_url}}",
          "options": {
            "fullPage": true,
            "type": "png"
          }
        },
        "headers": {
          "Content-Type": "application/json"
        }
      },
      "propagate_immediately": true,
      "sources": ["Research Trigger"]
    },
    {
      "type": "Agents::PostAgent",
      "name": "Agent S2 Data Extraction",
      "schedule": "never",
      "options": {
        "post_url": "http://localhost:4113/api/extract",
        "expected_receive_period_in_days": 1,
        "method": "post",
        "content_type": "json",
        "payload": {
          "url": "{{target_url}}",
          "selectors": {
            "title": "h1, .title, [class*='title']",
            "content": "article, .content, .main-content, p",
            "links": "a[href]",
            "images": "img[src]"
          },
          "options": {
            "waitForSelector": ".content",
            "timeout": 30000
          }
        },
        "headers": {
          "Content-Type": "application/json"
        }
      },
      "propagate_immediately": true,
      "sources": ["Browserless Screenshot"]
    },
    {
      "type": "Agents::PostAgent",
      "name": "Related Content Search",
      "schedule": "never",
      "options": {
        "post_url": "http://localhost:9200/search",
        "expected_receive_period_in_days": 1,
        "method": "get",
        "payload": {
          "q": "{{extracted_data.title}}",
          "format": "json",
          "engines": "google,bing,scholarly",
          "categories": "general,science"
        },
        "headers": {
          "User-Agent": "Huginn Research Bot"
        }
      },
      "propagate_immediately": true,
      "sources": ["Agent S2 Data Extraction"]
    },
    {
      "type": "Agents::PostAgent",
      "name": "AI Content Analysis",
      "schedule": "never",
      "options": {
        "post_url": "http://localhost:11434/api/generate",
        "expected_receive_period_in_days": 1,
        "method": "post",
        "content_type": "json",
        "payload": {
          "model": "llama3.1:8b",
          "prompt": "Analyze this web content and create a comprehensive research summary. Title: {{extracted_data.title}}. Content: {{extracted_data.content}}. Related search results: {{search_results}}. Please provide: 1) Key insights, 2) Main topics, 3) Credibility assessment, 4) Related concepts to research further.",
          "stream": false
        },
        "headers": {
          "Content-Type": "application/json"
        }
      },
      "propagate_immediately": true,
      "sources": ["Related Content Search"]
    },
    {
      "type": "Agents::PostAgent",
      "name": "Store Research Results",
      "schedule": "never",
      "options": {
        "post_url": "http://localhost:9000/research-results/{{extracted_data.title | slugify}}.json",
        "expected_receive_period_in_days": 1,
        "method": "put",
        "content_type": "json",
        "payload": {
          "timestamp": "{{date}}",
          "source_url": "{{target_url}}",
          "title": "{{extracted_data.title}}",
          "content": "{{extracted_data.content}}",
          "analysis": "{{ai_analysis.response}}",
          "search_results": "{{search_results}}",
          "screenshot_url": "{{screenshot.url}}",
          "metadata": {
            "extraction_method": "agent_s2",
            "analysis_model": "llama3.1:8b",
            "search_engine": "searxng"
          }
        },
        "headers": {
          "Content-Type": "application/json",
          "Authorization": "Bearer research-token"
        }
      },
      "propagate_immediately": true,
      "sources": ["AI Content Analysis"]
    },
    {
      "type": "Agents::PostAgent",
      "name": "Update Vector Database",
      "schedule": "never",
      "options": {
        "post_url": "http://localhost:6333/collections/research/points",
        "expected_receive_period_in_days": 1,
        "method": "put",
        "content_type": "json",
        "payload": {
          "points": [
            {
              "id": "{{extracted_data.title | md5}}",
              "vector": "{{ai_analysis.embedding}}",
              "payload": {
                "title": "{{extracted_data.title}}",
                "url": "{{target_url}}",
                "summary": "{{ai_analysis.summary}}",
                "topics": "{{ai_analysis.topics}}",
                "timestamp": "{{date}}"
              }
            }
          ]
        },
        "headers": {
          "Content-Type": "application/json"
        }
      },
      "propagate_immediately": false,
      "sources": ["Store Research Results"]
    }
  ],
  "links": [
    {
      "source": "Research Trigger",
      "receiver": "Browserless Screenshot"
    },
    {
      "source": "Browserless Screenshot",
      "receiver": "Agent S2 Data Extraction"  
    },
    {
      "source": "Agent S2 Data Extraction",
      "receiver": "Related Content Search"
    },
    {
      "source": "Related Content Search",
      "receiver": "AI Content Analysis"
    },
    {
      "source": "AI Content Analysis",
      "receiver": "Store Research Results"
    },
    {
      "source": "Store Research Results",
      "receiver": "Update Vector Database"
    }
  ]
}