{
  "code": "export default async ({ page, context }) => { try { const env = context.env || {}; const params = context.params || {}; const workflowId = params.workflow_id; const n8nUrl = params.n8n_url || 'http://localhost:5678'; const timeout = params.timeout || 60000; const inputData = params.input_data || {}; const workflowUrl = workflowId.startsWith('http') ? workflowId : `${n8nUrl}/workflow/${workflowId}`; await page.goto(workflowUrl, { waitUntil: 'networkidle2', timeout: 30000 }); let currentUrl = page.url(); if (currentUrl.includes('signin')) { await page.waitForSelector('input[type=\"email\"], #email', { timeout: 10000 }); await page.type('input[type=\"email\"], #email', env.N8N_EMAIL || 'matthalloran8@gmail.com'); await page.type('input[type=\"password\"], #password', env.N8N_PASSWORD || 'fallback'); const submitButtons = await page.$$('button'); for (const button of submitButtons) { const text = await page.evaluate(el => el.textContent, button); const type = await page.evaluate(el => el.type, button); if (type === 'submit' || text.includes('Sign in') || text.includes('Log in')) { await button.click(); break; } } await page.waitForNavigation({ waitUntil: 'networkidle2', timeout: 15000 }); await new Promise(resolve => setTimeout(resolve, 3000)); } const hasCanvas = await page.evaluate(() => { return !!document.querySelector('.workflow-canvas, .node-view-wrapper, [data-test-id=\"canvas\"]'); }); if (!hasCanvas) { return { success: false, error: 'Workflow not found or cannot access workflow canvas', currentUrl: page.url() }; } await page.waitForSelector('[title*=\"Execute\"], .execute-workflow-button, [data-test-id=\"execute-workflow-button\"]', { timeout: 10000 }); await page.click('[title*=\"Execute\"], .execute-workflow-button, [data-test-id=\"execute-workflow-button\"]'); const startTime = Date.now(); let executionComplete = false; let executionResult = null; while (!executionComplete && (Date.now() - startTime) < timeout) { await new Promise(resolve => setTimeout(resolve, 1000)); const status = await page.evaluate(() => { const hasSuccess = !!document.querySelector('.execution-success, [data-test-id=\"execution-success\"], .success-box'); const hasError = !!document.querySelector('.execution-error, [data-test-id=\"execution-error\"], .error-box'); const isRunning = !!document.querySelector('.execution-running, .running-box'); const errorText = document.querySelector('.error-message, .execution-error')?.textContent || ''; return { hasSuccess, hasError, isRunning, errorText }; }); if (status.hasSuccess) { executionComplete = true; executionResult = { success: true, status: 'success' }; } else if (status.hasError) { executionComplete = true; executionResult = { success: false, status: 'error', error: status.errorText }; } } if (!executionComplete) { return { success: false, error: 'Execution timed out', timeout: timeout }; } return { success: executionResult.success, workflowId: workflowId, executionStatus: executionResult.status, error: executionResult.error, currentUrl: page.url(), timestamp: new Date().toISOString() }; } catch (error) { return { success: false, error: error.message, workflowId: context.params?.workflow_id }; } };"
}