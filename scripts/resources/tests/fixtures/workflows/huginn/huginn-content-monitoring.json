{
  "scenario": {
    "name": "Content Monitoring and Analysis",
    "description": "Monitor web content changes and analyze with AI",
    "public": false,
    "source_url": null
  },
  "agents": [
    {
      "type": "Agents::WebsiteAgent",
      "name": "Website Monitor",
      "schedule": "every_1h",
      "options": {
        "url": "https://example.com/news",
        "type": "html",
        "mode": "on_change",
        "expected_update_period_in_days": 1,
        "extract": {
          "title": {
            "css": "h1",
            "value": "normalize-space(.)"
          },
          "content": {
            "css": "article .content",
            "value": "normalize-space(.)"
          },
          "url": {
            "css": "a",
            "value": "@href"
          }
        }
      },
      "propagate_immediately": true
    },
    {
      "type": "Agents::PostAgent",
      "name": "SearXNG Search",
      "schedule": "never",
      "options": {
        "post_url": "http://localhost:9200/search",
        "expected_receive_period_in_days": 1,
        "method": "get",
        "payload": {
          "q": "{{title}}",
          "format": "json",
          "engines": "google,bing,duckduckgo"
        },
        "headers": {
          "User-Agent": "Huginn Content Monitor"
        }
      },
      "propagate_immediately": true,
      "sources": ["Website Monitor"]
    },
    {
      "type": "Agents::PostAgent", 
      "name": "Ollama Analysis",
      "schedule": "never",
      "options": {
        "post_url": "http://localhost:11434/api/generate",
        "expected_receive_period_in_days": 1,
        "method": "post",
        "content_type": "json",
        "payload": {
          "model": "llama3.1:8b",
          "prompt": "Analyze this content for key themes and sentiment. Content: {{content}}. Related search results: {{search_results}}",
          "stream": false
        },
        "headers": {
          "Content-Type": "application/json"
        }
      },
      "propagate_immediately": true,
      "sources": ["SearXNG Search"]
    },
    {
      "type": "Agents::PostAgent",
      "name": "Store in QuestDB",
      "schedule": "never", 
      "options": {
        "post_url": "http://localhost:9009/exec",
        "expected_receive_period_in_days": 1,
        "method": "post",
        "payload": {
          "query": "INSERT INTO content_analysis (timestamp, title, sentiment, themes, url) VALUES (now(), '{{title}}', '{{analysis.sentiment}}', '{{analysis.themes}}', '{{url}}')"
        },
        "headers": {
          "Content-Type": "application/x-www-form-urlencoded"
        }
      },
      "propagate_immediately": false,
      "sources": ["Ollama Analysis"]
    },
    {
      "type": "Agents::PostAgent",
      "name": "Cache Results",
      "schedule": "never",
      "options": {
        "post_url": "http://localhost:6380",
        "expected_receive_period_in_days": 1,
        "method": "post",
        "payload": "SET content:{{title | md5}} '{{analysis | json}}'",
        "headers": {
          "Content-Type": "text/plain"
        }
      },
      "propagate_immediately": false,
      "sources": ["Ollama Analysis"]
    },
    {
      "type": "Agents::TriggerAgent",
      "name": "Alert on Negative Sentiment",
      "options": {
        "rules": [
          {
            "type": "field>=value",
            "path": "analysis.sentiment_score",
            "value": -0.5
          }
        ],
        "message": "Negative content detected: {{title}} - Sentiment: {{analysis.sentiment}}"
      },
      "sources": ["Ollama Analysis"]
    }
  ],
  "links": [
    {
      "source": "Website Monitor",
      "receiver": "SearXNG Search"
    },
    {
      "source": "SearXNG Search", 
      "receiver": "Ollama Analysis"
    },
    {
      "source": "Ollama Analysis",
      "receiver": "Store in QuestDB"
    },
    {
      "source": "Ollama Analysis",
      "receiver": "Cache Results"
    },
    {
      "source": "Ollama Analysis",
      "receiver": "Alert on Negative Sentiment"
    }
  ]
}