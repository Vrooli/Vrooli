{
  "name": "SWOT Analysis Workflow",
  "nodes": [
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "swot-analysis",
        "responseMode": "responseNode",
        "options": {}
      },
      "id": "webhook_trigger",
      "name": "Webhook Trigger",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 1,
      "position": [250, 300]
    },
    {
      "parameters": {
        "resource": "completion",
        "model": "{{ $json.model || 'llama3.2' }}",
        "prompt": "Perform a comprehensive SWOT analysis for:\n\n{{ $json.input }}\n\nContext: {{ $json.context || 'General business analysis' }}\n\nProvide:\n1. Strengths (internal positive factors)\n2. Weaknesses (internal negative factors)\n3. Opportunities (external positive factors)\n4. Threats (external negative factors)\n\nFor each item, include:\n- Description\n- Impact level (High/Medium/Low)\n- Actionability (Immediate/Short-term/Long-term)\n- Strategic recommendations\n\nFormat as structured JSON.",
        "temperature": 0.6,
        "maxTokens": 2500
      },
      "id": "generate_swot",
      "name": "Generate SWOT Analysis",
      "type": "n8n-nodes-base.ollama",
      "typeVersion": 1,
      "position": [450, 300]
    },
    {
      "parameters": {
        "functionCode": "const swot = JSON.parse($node['Generate SWOT Analysis'].json.response);\n\n// Calculate strategic position\nconst internal_score = swot.strengths.length - swot.weaknesses.length;\nconst external_score = swot.opportunities.length - swot.threats.length;\n\nlet strategic_position = '';\nif (internal_score > 0 && external_score > 0) {\n  strategic_position = 'Aggressive (leverage strengths for opportunities)';\n} else if (internal_score > 0 && external_score < 0) {\n  strategic_position = 'Competitive (use strengths to counter threats)';\n} else if (internal_score < 0 && external_score > 0) {\n  strategic_position = 'Conservative (fix weaknesses to capture opportunities)';\n} else {\n  strategic_position = 'Defensive (minimize weaknesses and avoid threats)';\n}\n\nreturn {\n  json: {\n    swot_analysis: swot,\n    strategic_position: strategic_position,\n    metrics: {\n      total_strengths: swot.strengths.length,\n      total_weaknesses: swot.weaknesses.length,\n      total_opportunities: swot.opportunities.length,\n      total_threats: swot.threats.length,\n      internal_balance: internal_score,\n      external_balance: external_score\n    },\n    generated_at: new Date().toISOString()\n  }\n};"
      },
      "id": "analyze_position",
      "name": "Analyze Strategic Position",
      "type": "n8n-nodes-base.function",
      "typeVersion": 1,
      "position": [650, 300]
    },
    {
      "parameters": {
        "resource": "completion",
        "model": "{{ $json.model || 'mistral' }}",
        "prompt": "Based on this SWOT analysis:\n{{ JSON.stringify($node['Analyze Strategic Position'].json.swot_analysis) }}\n\nStrategic Position: {{ $node['Analyze Strategic Position'].json.strategic_position }}\n\nProvide 5 specific, actionable strategic recommendations prioritized by impact and feasibility.",
        "temperature": 0.7,
        "maxTokens": 1000
      },
      "id": "generate_recommendations",
      "name": "Generate Strategic Recommendations",
      "type": "n8n-nodes-base.ollama",
      "typeVersion": 1,
      "position": [850, 300]
    },
    {
      "parameters": {
        "operation": "insert",
        "table": "execution_history",
        "columns": "resource_type,resource_id,input_data,output_data,execution_time_ms,status,model_used",
        "returnFields": "id"
      },
      "id": "save_history",
      "name": "Save to History",
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 1,
      "position": [1050, 300]
    },
    {
      "parameters": {
        "values": {
          "string": [
            {
              "name": "status",
              "value": "success"
            }
          ]
        },
        "options": {}
      },
      "id": "response",
      "name": "Send Response",
      "type": "n8n-nodes-base.set",
      "typeVersion": 1,
      "position": [1250, 300]
    }
  ],
  "connections": {
    "webhook_trigger": {
      "main": [[{"node": "generate_swot", "type": "main", "index": 0}]]
    },
    "generate_swot": {
      "main": [[{"node": "analyze_position", "type": "main", "index": 0}]]
    },
    "analyze_position": {
      "main": [[{"node": "generate_recommendations", "type": "main", "index": 0}]]
    },
    "generate_recommendations": {
      "main": [[{"node": "save_history", "type": "main", "index": 0}]]
    },
    "save_history": {
      "main": [[{"node": "response", "type": "main", "index": 0}]]
    }
  },
  "active": true,
  "settings": {
    "executionOrder": "v1"
  },
  "id": "swot-analysis"
}