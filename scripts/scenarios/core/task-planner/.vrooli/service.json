{
  "$schema": "../../../../.vrooli/schemas/service.schema.json",
  "version": "1.0.0",
  "inheritance": {
    "extends": "../../../../../.vrooli/service.json",
    "merge": {
      "strategy": "merge",
      "arrays": "concat"
    }
  },
  "service": {
    "name": "task-planner",
    "displayName": "Task Planner",
    "description": "General task planner and scheduler with AI-powered task refinement and implementation",
    "version": "1.0.0",
    "type": "business-application",
    "category": "saas-applications",
    "tags": [
      "task-management",
      "planning",
      "scheduling",
      "ai"
    ],
    "maintainers": [
      {
        "name": "Vrooli Team",
        "email": "team@vrooli.com",
        "url": "https://github.com/Vrooli"
      }
    ],
    "license": "GPL-3.0",
    "homepage": "https://github.com/Vrooli/Vrooli"
  },
  "resources": {
    "storage": {
      "postgres": {
        "enabled": true,
        "config": {
          "database": "task_planner",
          "port": 5434,
          "username": "taskplanner_user",
          "password": "${POSTGRES_PASSWORD}",
          "initialization": {
            "schema": "initialization/storage/postgres/schema.sql",
            "seed": "initialization/storage/postgres/seed.sql"
          }
        }
      },
      "redis": {
        "enabled": true,
        "config": {
          "database": 0,
          "keyPrefix": "task_planner:"
        }
      },
      "qdrant": {
        "enabled": true,
        "config": {
          "collections": ["task_embeddings", "research_embeddings"],
          "port": 6334,
          "vectorSize": 1536,
          "initialization": {
            "collections": "initialization/storage/qdrant/collections.json"
          }
        }
      }
    },
    "automation": {
      "n8n": {
        "enabled": true,
        "config": {
          "workflows": [
            "initialization/automation/n8n/task-parser.json",
            "initialization/automation/n8n/task-researcher.json",
            "initialization/automation/n8n/task-implementer.json",
            "initialization/automation/n8n/status-monitor.json"
          ]
        }
      },
      "windmill": {
        "enabled": true,
        "config": {
          "workspace": "task_planner",
          "scripts": [
            "initialization/automation/windmill/scripts/parse-unstructured.ts",
            "initialization/automation/windmill/scripts/research-task.ts",
            "initialization/automation/windmill/scripts/generate-plan.ts",
            "initialization/automation/windmill/scripts/implement-task.ts",
            "initialization/automation/windmill/scripts/update-status.ts"
          ],
          "apps": [
            "initialization/automation/windmill/task-dashboard.json"
          ]
        }
      }
    },
    "ai": {
      "claude-code": {
        "enabled": true,
        "config": {
          "model": "claude-3-opus-20240229",
          "maxTokens": 8192,
          "temperature": 0.3,
          "purpose": "task_implementation"
        }
      },
      "ollama": {
        "enabled": true,
        "config": {
          "models": ["llama3.2", "nomic-embed-text"],
          "embeddings": {
            "model": "nomic-embed-text",
            "dimensions": 1536
          },
          "primary_use": "task_analysis_and_embeddings"
        }
      }
    },
    "search": {
      "searxng": {
        "enabled": true,
        "config": {
          "purpose": "research_for_task_context",
          "engines": ["duckduckgo", "github", "stackoverflow", "wikipedia"],
          "port": 9201
        }
      }
    },
    "agents": {
      "agent-s2": {
        "enabled": true,
        "config": {
          "purpose": "web_research_for_tasks",
          "maxInstances": 3
        }
      }
    }
  },
  "deployment": {
    "ports": {
      "windmill": 8001,
      "api": 8092,
      "n8n": 5679,
      "ui": 3001
    },
    "environment": {
      "NODE_ENV": "production",
      "LOG_LEVEL": "info",
      "CLAUDE_API_KEY": "${CLAUDE_API_KEY}",
      "TASK_PLANNER_API_PORT": "8092",
      "TASK_PLANNER_SECRET": "${TASK_PLANNER_SECRET}"
    }
  },
  "lifecycle": {
    "version": "1.0.0",
    "setup": {
      "description": "Initialize Task Planner environment with API server and CLI tool",
      "steps": [
        {
          "name": "inject-resource-data",
          "run": "scripts/scenarios/injection/runtime-engine.sh scripts/scenarios/core/task-planner/.vrooli/service.json",
          "description": "Inject SQL schemas, workflows, and configurations"
        },
        {
          "name": "install-cli-tool",
          "run": "chmod +x cli/task-planner-cli.sh && sudo ln -sf $PWD/cli/task-planner-cli.sh /usr/local/bin/task-planner",
          "description": "Install task-planner CLI tool globally"
        },
        {
          "name": "install-api-dependencies",
          "run": "cd deployment && npm install express cors helmet express-rate-limit pg ioredis axios uuid",
          "description": "Install Node.js dependencies for API server"
        },
        {
          "name": "setup-database",
          "run": "deployment/setup-postgres.sh",
          "description": "Initialize PostgreSQL database with schemas"
        },
        {
          "name": "setup-vector-db",
          "run": "deployment/setup-qdrant.sh",
          "description": "Initialize Qdrant vector database with collections"
        },
        {
          "name": "import-automations",
          "run": "deployment/import-automations.sh",
          "description": "Import n8n workflows and Windmill scripts"
        },
        {
          "name": "start-api-server",
          "run": "deployment/startup.sh",
          "description": "Start API server and all required services"
        },
        {
          "name": "show-access-urls",
          "run": "echo '‚úÖ Task Planner initialized\\n  üéØ Task Dashboard: http://localhost:8001/apps/get/task-dashboard\\n  üîß API Endpoint: http://localhost:8092/api\\n  üîç n8n Workflows: http://localhost:5679\\n  ‚öôÔ∏è  Windmill Workspace: http://localhost:8001/w/task_planner\\n  üìä PostgreSQL: localhost:5434/task_planner\\n  üîç Qdrant: http://localhost:6334\\n  üì¶ CLI: task-planner --help'",
          "description": "Display service access URLs and CLI usage"
        }
      ]
    }
  }
}