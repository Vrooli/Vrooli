{
  "name": "campaign-manager",
  "nodes": [
    {
      "parameters": {},
      "id": "webhook-trigger",
      "name": "Webhook",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [
        250,
        300
      ],
      "webhookId": "campaign-manager-webhook"
    },
    {
      "parameters": {},
      "id": "manual-trigger",
      "name": "Manual Trigger",
      "type": "n8n-nodes-base.manualTrigger",
      "typeVersion": 1,
      "position": [
        250,
        500
      ]
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "action",
              "name": "action",
              "value": "={{ $json.action || 'list' }}",
              "type": "string"
            },
            {
              "id": "campaign_name",
              "name": "campaign_name",
              "value": "={{ $json.campaign_name || 'Default Campaign' }}",
              "type": "string"
            },
            {
              "id": "prompts",
              "name": "prompts",
              "value": "={{ $json.prompts || [] }}",
              "type": "array"
            },
            {
              "id": "search_query",
              "name": "search_query",
              "value": "={{ $json.search_query || '' }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "id": "provide-defaults",
      "name": "Provide Defaults",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        450,
        500
      ]
    },
    {
      "parameters": {
        "rules": {
          "rules": [
            {
              "conditions": {
                "conditions": [
                  {
                    "leftValue": "={{ $json.action }}",
                    "rightValue": "create",
                    "operation": {
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ]
              },
              "outputKey": "create"
            },
            {
              "conditions": {
                "conditions": [
                  {
                    "leftValue": "={{ $json.action }}",
                    "rightValue": "search",
                    "operation": {
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ]
              },
              "outputKey": "search"
            },
            {
              "conditions": {
                "conditions": [
                  {
                    "leftValue": "={{ $json.action }}",
                    "rightValue": "list",
                    "operation": {
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ]
              },
              "outputKey": "list"
            },
            {
              "conditions": {
                "conditions": [
                  {
                    "leftValue": "={{ $json.action }}",
                    "rightValue": "update",
                    "operation": {
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ]
              },
              "outputKey": "update"
            }
          ]
        },
        "options": {
          "fallbackOutput": "extra"
        }
      },
      "id": "route-by-action",
      "name": "Route by Action",
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3,
      "position": [
        650,
        400
      ]
    },
    {
      "parameters": {
        "jsCode": "// Create a new campaign with prompts\nconst campaignId = `campaign_${Date.now()}`;\nconst timestamp = new Date().toISOString();\n\nconst campaign = {\n  id: campaignId,\n  name: $input.first().json.campaign_name,\n  prompts: $input.first().json.prompts || [],\n  created_at: timestamp,\n  updated_at: timestamp,\n  stats: {\n    total_prompts: ($input.first().json.prompts || []).length,\n    total_uses: 0,\n    last_used: null\n  },\n  metadata: {\n    tags: [],\n    description: $input.first().json.description || '',\n    category: $input.first().json.category || 'general'\n  }\n};\n\n// Format prompts with IDs and metadata\ncampaign.prompts = campaign.prompts.map((prompt, index) => {\n  if (typeof prompt === 'string') {\n    return {\n      id: `prompt_${campaignId}_${index}`,\n      content: prompt,\n      created_at: timestamp,\n      usage_count: 0,\n      tags: [],\n      variables: []\n    };\n  }\n  return {\n    ...prompt,\n    id: prompt.id || `prompt_${campaignId}_${index}`,\n    created_at: prompt.created_at || timestamp\n  };\n});\n\nreturn {\n  success: true,\n  action: 'created',\n  campaign: campaign,\n  message: `Campaign '${campaign.name}' created with ${campaign.prompts.length} prompts`\n};"
      },
      "id": "create-campaign",
      "name": "Create Campaign",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        850,
        200
      ]
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "query",
              "name": "query",
              "value": "={{ $json.search_query }}",
              "type": "string"
            },
            {
              "id": "collection",
              "name": "collection",
              "value": "prompts",
              "type": "string"
            },
            {
              "id": "limit",
              "name": "limit",
              "value": "={{ $json.limit || 10 }}",
              "type": "number"
            }
          ]
        },
        "options": {}
      },
      "id": "prepare-search",
      "name": "Prepare Search",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        850,
        350
      ]
    },
    {
      "parameters": {
        "operation": "call",
        "source": "parameter",
        "workflowId": "={{ $env.SHARED_WORKFLOW_IDS['smart-semantic-search'] }}"
      },
      "id": "semantic-search",
      "name": "Semantic Search",
      "type": "n8n-nodes-base.n8n",
      "typeVersion": 1.2,
      "position": [
        1050,
        350
      ]
    },
    {
      "parameters": {
        "jsCode": "// List all campaigns (mock data for now)\nconst mockCampaigns = [\n  {\n    id: 'campaign_001',\n    name: 'Content Marketing',\n    prompts_count: 15,\n    created_at: '2025-01-15T10:00:00Z',\n    last_used: '2025-01-15T14:30:00Z',\n    tags: ['marketing', 'content', 'blog']\n  },\n  {\n    id: 'campaign_002',\n    name: 'Code Generation',\n    prompts_count: 23,\n    created_at: '2025-01-14T09:00:00Z',\n    last_used: '2025-01-15T16:45:00Z',\n    tags: ['development', 'code', 'ai']\n  },\n  {\n    id: 'campaign_003',\n    name: 'Customer Support',\n    prompts_count: 8,\n    created_at: '2025-01-13T11:00:00Z',\n    last_used: '2025-01-15T12:00:00Z',\n    tags: ['support', 'customer', 'faq']\n  }\n];\n\nreturn {\n  success: true,\n  action: 'list',\n  campaigns: mockCampaigns,\n  total: mockCampaigns.length,\n  message: `Found ${mockCampaigns.length} campaigns`\n};"
      },
      "id": "list-campaigns",
      "name": "List Campaigns",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        850,
        500
      ]
    },
    {
      "parameters": {
        "jsCode": "// Update campaign prompts\nconst timestamp = new Date().toISOString();\nconst input = $input.first().json;\n\nconst updatedCampaign = {\n  id: input.campaign_id || `campaign_${Date.now()}`,\n  name: input.campaign_name,\n  prompts: input.prompts || [],\n  updated_at: timestamp,\n  action_performed: 'update',\n  changes: {\n    prompts_added: input.prompts_to_add?.length || 0,\n    prompts_removed: input.prompts_to_remove?.length || 0,\n    metadata_updated: input.metadata ? true : false\n  }\n};\n\nreturn {\n  success: true,\n  action: 'updated',\n  campaign: updatedCampaign,\n  message: `Campaign '${updatedCampaign.name}' updated successfully`\n};"
      },
      "id": "update-campaign",
      "name": "Update Campaign",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        850,
        650
      ]
    },
    {
      "parameters": {
        "mode": "combine",
        "combinationMode": "multiplex",
        "options": {}
      },
      "id": "merge-results",
      "name": "Merge Results",
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3,
      "position": [
        1250,
        400
      ]
    },
    {
      "parameters": {
        "options": {}
      },
      "id": "respond-to-webhook",
      "name": "Respond to Webhook",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.1,
      "position": [
        1450,
        400
      ]
    }
  ],
  "connections": {
    "webhook-trigger": {
      "main": [
        [
          {
            "node": "route-by-action",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "manual-trigger": {
      "main": [
        [
          {
            "node": "provide-defaults",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "provide-defaults": {
      "main": [
        [
          {
            "node": "route-by-action",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "route-by-action": {
      "main": [
        [
          {
            "node": "create-campaign",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "prepare-search",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "list-campaigns",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "update-campaign",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "create-campaign": {
      "main": [
        [
          {
            "node": "merge-results",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "prepare-search": {
      "main": [
        [
          {
            "node": "semantic-search",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "semantic-search": {
      "main": [
        [
          {
            "node": "merge-results",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "list-campaigns": {
      "main": [
        [
          {
            "node": "merge-results",
            "type": "main",
            "index": 2
          }
        ]
      ]
    },
    "update-campaign": {
      "main": [
        [
          {
            "node": "merge-results",
            "type": "main",
            "index": 3
          }
        ]
      ]
    },
    "merge-results": {
      "main": [
        [
          {
            "node": "respond-to-webhook",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "campaign-manager-v1",
  "tags": [],
  "pinData": {},
  "staticData": null
}