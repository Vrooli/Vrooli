{
  "name": "Contact Enricher",
  "nodes": [
    {
      "parameters": {},
      "id": "webhook-trigger",
      "name": "Webhook",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 1,
      "position": [250, 300],
      "webhookId": "contact-enricher"
    },
    {
      "parameters": {
        "values": {
          "string": [
            {
              "name": "contact_id",
              "value": "1"
            },
            {
              "name": "name",
              "value": "John Doe"
            }
          ]
        }
      },
      "id": "defaults",
      "name": "Manual Defaults",
      "type": "n8n-nodes-base.set",
      "typeVersion": 1,
      "position": [250, 500]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "={{$env.service.n8n.url}}/webhook/ollama",
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "prompt",
              "value": "Based on the name '{{$json.name}}', suggest potential interests and personality traits that might be common. Also suggest thoughtful questions to ask to get to know them better.\n\nProvide:\n1. 5-7 potential interests (as a comma-separated list)\n2. 3-4 personality traits that might align\n3. 5 thoughtful conversation starters\n\nFormat as JSON with keys: interests, traits, conversation_starters"
            },
            {
              "name": "model",
              "value": "llama3.2"
            },
            {
              "name": "temperature",
              "value": "0.6"
            }
          ]
        }
      },
      "id": "enrich-contact",
      "name": "Enrich Contact Info",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 3,
      "position": [450, 400]
    },
    {
      "parameters": {
        "mode": "runOnceForAllItems",
        "jsCode": "const response = $input.first().json;\nconst contact_id = $node[\"Webhook\"].json.contact_id || $node[\"defaults\"].json.contact_id;\n\nlet enrichedData = {\n  interests: [],\n  traits: [],\n  conversation_starters: []\n};\n\ntry {\n  const parsed = JSON.parse(response.content || response.response || '{}');\n  enrichedData = {\n    interests: parsed.interests || [],\n    traits: parsed.traits || [],\n    conversation_starters: parsed.conversation_starters || []\n  };\n} catch (e) {\n  // Fallback data\n  enrichedData = {\n    interests: ['reading', 'travel', 'music', 'food', 'sports'],\n    traits: ['thoughtful', 'curious', 'friendly'],\n    conversation_starters: [\n      \"What's been the highlight of your week?\",\n      \"Have you discovered any new hobbies lately?\",\n      \"What's on your bucket list?\",\n      \"What book/movie/show would you recommend?\",\n      \"What's your favorite way to spend a weekend?\"\n    ]\n  };\n}\n\nreturn {\n  contact_id: contact_id,\n  enriched_data: enrichedData,\n  timestamp: new Date().toISOString()\n};"
      },
      "id": "process-enrichment",
      "name": "Process Enrichment",
      "type": "n8n-nodes-base.code",
      "typeVersion": 1,
      "position": [650, 400]
    },
    {
      "parameters": {
        "values": {
          "string": [
            {
              "name": "status",
              "value": "success"
            }
          ]
        }
      },
      "id": "response",
      "name": "Response",
      "type": "n8n-nodes-base.set",
      "typeVersion": 1,
      "position": [850, 400]
    }
  ],
  "connections": {
    "Webhook": {
      "main": [
        [
          {
            "node": "Enrich Contact Info",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Manual Defaults": {
      "main": [
        [
          {
            "node": "Enrich Contact Info",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Enrich Contact Info": {
      "main": [
        [
          {
            "node": "Process Enrichment",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Process Enrichment": {
      "main": [
        [
          {
            "node": "Response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": true,
  "settings": {},
  "id": "contact-enricher"
}