version: 1.0
scenario: audio-intelligence-platform

# Structure validation
structure:
  required_files:
    - .vrooli/service.json
    - IMPLEMENTATION_PLAN.md
    - initialization/storage/postgres/schema.sql
    - initialization/storage/postgres/seed.sql
    - initialization/automation/n8n/transcription-pipeline.json
    - initialization/automation/n8n/ai-analysis-workflow.json
    - initialization/automation/n8n/semantic-search.json
    - initialization/automation/windmill/transcription-manager-app.json
    - initialization/automation/windmill/scripts/upload-handler.ts
    - initialization/automation/windmill/scripts/search-handler.ts
    - initialization/automation/windmill/scripts/ai-analysis.ts
    - initialization/configuration/search-config.json
    - initialization/configuration/transcription-config.json
    - initialization/configuration/ui-config.json
    - api/main.go
    - api/go.mod
    - cli/audio-intelligence-platform-cli.sh
    - cli/install-cli.sh
    - cli/audio-intelligence-platform.bats
    - test/test-analysis-endpoint.sh
    - test.sh
    - custom-tests.sh
  
  required_dirs:
    - .vrooli
    - initialization/storage/postgres
    - initialization/automation
    - initialization/automation/n8n
    - initialization/automation/windmill
    - initialization/automation/windmill/scripts
    - initialization/configuration
    - api
    - cli
    - test

# Resource requirements  
resources:
  required: [postgres, minio, qdrant, whisper, ollama, n8n, windmill]
  optional: []
  health_timeout: 45

# Declarative tests
tests:
  - name: "Application Health Check"
    type: http
    service: app
    endpoint: /health
    method: GET
    expect:
      status: 200
      body:
        type: json

  - name: "AI Model Engine Ready"
    type: http
    service: ollama
    endpoint: /api/tags
    method: GET
    expect:
      status: 200
      body:
        type: json
        
  - name: "Audio Transcription Engine Ready"
    type: http
    service: whisper
    endpoint: /health
    method: GET
    expect:
      status: 200
      
  - name: "Vector Database Ready"
    type: http
    service: qdrant
    endpoint: /health
    method: GET
    expect:
      status: 200

  - name: "File Storage Ready"
    type: http
    service: minio
    endpoint: /minio/health/live
    method: GET
    expect:
      status: 200
      
  - name: "Workflow Automation Ready"
    type: http
    service: n8n
    endpoint: /healthz
    method: GET
    expect:
      status: 200
      
  - name: "Professional UI Ready"
    type: http
    service: windmill
    endpoint: /api/version
    method: GET
    expect:
      status: 200

  - name: "Database Connection"
    type: tcp
    service: postgres
    port: 5433

  - name: "API Transcriptions Endpoint"
    type: http
    service: app
    endpoint: /api/transcriptions
    method: GET
    expect:
      status: 200
      body:
        type: json
        
  - name: "Audio Intelligence Platform Workflow"
    type: custom
    script: custom-tests.sh
    function: test_audio_intelligence_platform_workflow

# Validation criteria
validation:
  success_rate: 85        # High success rate for content automation platform
  response_time: 18000    # 18 seconds max for transcription and analysis operations
  revenue_potential: 40000  # Total estimate from service.json
  business_criteria:
    - "AI-powered audio intelligence platform operational"
    - "Automated transcription and analysis functional"
    - "Semantic search and content discovery validated"
    - "Professional workflow automation verified"
    - "Content creator productivity tools confirmed"