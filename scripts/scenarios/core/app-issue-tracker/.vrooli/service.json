{
  "$schema": "../../../../.vrooli/schemas/service.schema.json",
  "version": "1.0.0",
  "inheritance": {
    "extends": "../../../../../.vrooli/service.json",
    "merge": {
      "strategy": "merge",
      "arrays": "concat"
    }
  },
  "service": {
    "name": "app-issue-tracker",
    "displayName": "App Issue Tracker",
    "description": "Centralized issue tracking hub for all Vrooli-generated applications with AI-powered investigation",
    "version": "1.0.0",
    "type": "scenario",
    "category": "vrooli-helpers",
    "tags": [
      "issue-tracking",
      "ai-investigation",
      "debugging",
      "monitoring",
      "claude-integration"
    ]
  },
  "resources": {
    "storage": {
      "postgres": {
        "type": "postgresql",
        "enabled": true,
        "version": "16",
        "required": true,
        "initialization": {
          "data": [
            {
              "type": "schema",
              "file": "initialization/storage/postgres/schema.sql"
            },
            {
              "type": "seed",
              "file": "initialization/storage/postgres/seed.sql"
            }
          ]
        }
      },
      "qdrant": {
        "type": "qdrant",
        "enabled": true,
        "required": true,
        "initialization": {
          "collections": [
            {
              "name": "issues",
              "vector_size": 1536,
              "distance": "Cosine"
            }
          ]
        }
      },
      "redis": {
        "type": "redis",
        "enabled": true,
        "required": true
      },
      "minio": {
        "type": "minio",
        "enabled": true,
        "required": true,
        "initialization": {
          "buckets": [
            {
              "name": "issue-artifacts",
              "public": false,
              "retention": "30d"
            }
          ]
        }
      }
    },
    "automation": {
      "windmill": {
        "type": "windmill",
        "enabled": true,
        "required": true,
        "initialization": {
          "apps": [
            { "file": "initialization/automation/windmill/apps/dashboard.json" },
            { "file": "initialization/automation/windmill/apps/metrics.json" },
            { "file": "initialization/automation/windmill/apps/agents.json" }
          ]
        }
      },
      "n8n": {
        "type": "n8n",
        "enabled": true,
        "required": true,
        "initialization": {
          "workflows": [
            { "file": "initialization/automation/n8n/claude-investigation.json" },
            { "file": "initialization/automation/n8n/issue-ingestion.json" }
          ]
        }
      }
    },
    "ai": {
      "claude-code": {
        "type": "claude-code",
        "enabled": true,
        "required": false
      },
      "ollama": {
        "type": "ollama",
        "enabled": true,
        "required": true,
        "models": ["nomic-embed-text", "llama3.2"]
      }
    }
  },
  "cli": {
    "name": "vrooli-tracker",
    "description": "CLI for managing issues across Vrooli applications",
    "installation": {
      "script": "deployment/install-cli.sh"
    }
  },
  "api": {
    "port": 8091,
    "endpoints": [
      "/api/issues",
      "/api/issues/search",
      "/api/issues/investigate",
      "/api/metrics"
    ],
    "startup": "deployment/start-api-server.sh"
  },
  "lifecycle": {
    "version": "1.0.0",
    "setup": {
      "description": "Initialize issue tracker with CLI, API, and data injection",
      "steps": [
        {
          "name": "inject-resource-data",
          "run": "scripts/scenarios/injection/runtime-engine.sh scripts/scenarios/core/app-issue-tracker/.vrooli/service.json",
          "description": "Inject SQL schemas, workflows, and configurations"
        },
        {
          "name": "install-cli",
          "run": "deployment/install-cli.sh",
          "description": "Install vrooli-tracker CLI tool"
        },
        {
          "name": "generate-api-token",
          "run": "openssl rand -hex 32 > /tmp/issue-tracker-api-token && echo 'API Token generated: '$(cat /tmp/issue-tracker-api-token)",
          "description": "Generate secure API access token"
        },
        {
          "name": "start-api-server",
          "run": "deployment/start-api-server.sh &",
          "description": "Start issue tracker API server"
        },
        {
          "name": "show-access-urls",
          "run": "echo 'âœ… App Issue Tracker initialized\\n  Dashboard: http://localhost:${RESOURCE_PORTS[windmill]}\\n  n8n Workflows: http://localhost:${RESOURCE_PORTS[n8n]}\\n  API: http://localhost:8091\\n  CLI: vrooli-tracker --help'",
          "description": "Display service access information"
        }
      ]
    }
  }
}