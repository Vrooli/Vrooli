export class ZshCompletionGenerator {
    generate(commandName: string): string {
        return `#compdef ${commandName}
# Zsh completion for ${commandName}
# This file is generated by '${commandName} completion install'

_${commandName}() {
    local -a completions
    local -a completions_with_descriptions
    local current_word
    current_word="\${words[CURRENT]}"
    
    # Call the CLI with special completion flag
    local completion_output
    completion_output=$(${commandName} --generate-completions "\${words[@]}" 2>/dev/null)
    
    if [[ -n "$completion_output" ]]; then
        # Parse completions
        while IFS= read -r line; do
            if [[ "$line" == *:* ]]; then
                # Completion with description
                completions_with_descriptions+=("$line")
            else
                # Completion without description
                completions_with_descriptions+=("$line:$line")
            fi
        done <<< "$completion_output"
        
        if [[ \${#completions_with_descriptions[@]} -gt 0 ]]; then
            _describe '' completions_with_descriptions
            return 0
        fi
    fi
    
    # Fallback to file completion
    _files
}

# Register the completion function
_${commandName}
`;
    }
}
