{
  "$schema": "../schemas/service.schema.json",
  "version": "1.0.0",
  "service": {
    "name": "my-ai-assistant",
    "displayName": "My AI Assistant",
    "description": "A complete AI assistant application built on Vrooli",
    "version": "1.0.0",
    "type": "application",
    "tags": [
      "ai",
      "assistant",
      "chat",
      "automation"
    ],
    "maintainers": [
      {
        "name": "Your Name",
        "email": "you@example.com",
        "url": "https://github.com/yourusername"
      }
    ],
    "repository": {
      "type": "git",
      "url": "https://github.com/yourusername/my-ai-assistant",
      "directory": "/"
    },
    "license": "MIT",
    "homepage": "https://my-ai-assistant.com",
    "documentation": "https://docs.my-ai-assistant.com",
    "support": {
      "email": "support@my-ai-assistant.com",
      "issues": "https://github.com/yourusername/my-ai-assistant/issues"
    }
  },
  "resources": {
    "storage": {
      "postgres": {
        "type": "postgresql",
        "enabled": true,
        "version": "16",
        "host": "localhost",
        "port": 5432,
        "database": "ai_assistant",
        "username": "assistant_user",
        "password": {
          "name": "DB_PASSWORD",
          "key": "value",
          "provider": "env"
        },
        "ssl": false,
        "pool": {
          "min": 2,
          "max": 10
        },
        "healthCheck": {
          "type": "tcp",
          "port": 5432,
          "intervalMs": 30000
        }
      },
      "redis": {
        "type": "redis",
        "enabled": true,
        "version": "7",
        "host": "localhost",
        "port": 6379,
        "persistence": true,
        "maxMemory": "1Gi",
        "healthCheck": {
          "type": "tcp",
          "port": 6379,
          "intervalMs": 30000
        }
      }
    },
    "ai": {
      "ollama": {
        "type": "ollama",
        "enabled": true,
        "provider": "local",
        "baseUrl": "http://localhost:11434",
        "models": [
          {
            "name": "llama3.1:8b",
            "type": "llm"
          }
        ],
        "healthCheck": {
          "type": "http",
          "endpoint": "/api/tags",
          "intervalMs": 300000
        }
      }
    },
    "execution": {
      "bullmq": {
        "type": "bullmq",
        "enabled": true,
        "host": "localhost",
        "port": 6379,
        "queues": [
          {
            "name": "chat",
            "durable": true,
            "maxRetries": 3
          }
        ]
      }
    }
  },
  "execution": {
    "version": "1.0.0",
    "enabled": true,
    "environments": {
      "development": {
        "name": "development",
        "sandboxing": {
          "type": "process",
          "isolation": "partial"
        },
        "permissions": {
          "filesystem": {
            "read": {
              "allowed": [
                "./"
              ]
            },
            "write": {
              "allowed": [
                "./tmp",
                "./uploads"
              ]
            }
          },
          "network": {
            "enabled": true
          }
        },
        "limits": {
          "timeout": "60s",
          "memory": "1Gi",
          "cpu": "2"
        }
      }
    }
  },
  "scenarios": {
    "local-development": {
      "name": "local-development",
      "category": "development",
      "resources": {
        "include": [
          "storage.postgres",
          "storage.redis",
          "ai.ollama",
          "execution.bullmq"
        ]
      },
      "deployment": {
        "target": "local"
      },
      "initialization": {
        "phases": [
          {
            "name": "setup-database",
            "tasks": [
              {
                "name": "migrate",
                "type": "command",
                "command": [
                  "npm",
                  "run",
                  "db:migrate"
                ]
              }
            ]
          },
          {
            "name": "setup-ai",
            "tasks": [
              {
                "name": "pull-model",
                "type": "command",
                "command": [
                  "ollama",
                  "pull",
                  "llama3.1:8b"
                ]
              }
            ]
          }
        ]
      }
    },
    "production": {
      "name": "production",
      "category": "production",
      "resources": {
        "required": [
          "storage.postgres",
          "storage.redis",
          "ai.ollama",
          "execution.bullmq"
        ]
      },
      "deployment": {
        "target": "kubernetes",
        "strategy": "rolling"
      }
    }
  },
  "serve": {
    "version": "1.0.0",
    "deployment": {
      "targets": {
        "local": {
          "type": "local",
          "enabled": true,
          "environment": "development"
        },
        "kubernetes": {
          "type": "kubernetes",
          "enabled": true,
          "environment": "production",
          "namespace": "ai-assistant"
        }
      }
    },
    "monitoring": {
      "metrics": {
        "enabled": true,
        "provider": "prometheus"
      },
      "logging": {
        "enabled": true,
        "level": "info",
        "format": "json"
      }
    },
    "scaling": {
      "horizontal": {
        "enabled": true,
        "min": 1,
        "max": 5,
        "metrics": [
          {
            "type": "cpu",
            "target": 70
          }
        ]
      }
    }
  },
  "inheritance": {
    "extends": "../service.json",
    "overrides": {
      "resources": true,
      "scenarios": true
    }
  },
  "lifecycle": {
    "hooks": {
      "preStart": {
        "exec": {
          "command": [
            "./scripts/health-check.sh"
          ]
        }
      }
    },
    "dependencies": {
      "services": [
        {
          "name": "postgres",
          "required": true,
          "checkHealth": true
        },
        {
          "name": "redis",
          "required": true,
          "checkHealth": true
        }
      ]
    },
    "readiness": {
      "httpGet": {
        "path": "/health/ready",
        "port": 3000
      }
    }
  },
  "documentation": {
    "api": {
      "openapi": "./docs/api.yaml"
    },
    "guides": [
      {
        "title": "Getting Started",
        "path": "./docs/getting-started.md",
        "type": "quickstart"
      }
    ]
  }
}