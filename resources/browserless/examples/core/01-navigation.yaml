workflow:
  name: "navigation-fundamentals"
  description: "Essential navigation patterns - page loads, screenshots, redirects, and wait strategies"
  version: "1.0.0"
  
  # This example demonstrates core navigation concepts:
  # 1. Basic page navigation
  # 2. Taking screenshots
  # 3. Handling redirects
  # 4. Wait strategies for dynamic content
  # 5. Error handling for failed navigations

config:
  timeout: 30000
  viewport:
    width: 1920
    height: 1080
  output_dir: "${context.outputDir}/navigation"

steps:
  # ============================================
  # BASIC NAVIGATION
  # ============================================
  - name: "simple_navigation"
    action: "navigate"
    url: "https://example.com"
    wait_until: "networkidle2"
    description: "Basic page navigation with network idle wait"

  - name: "capture_screenshot"
    action: "screenshot"
    path: "${context.outputDir}/example-homepage.png"
    full_page: true
    description: "Capture full page screenshot"

  # ============================================
  # REDIRECT HANDLING
  # ============================================
  - name: "navigate_with_redirect"
    action: "navigate"
    url: "http://github.com"  # HTTP redirects to HTTPS
    wait_until: "domcontentloaded"
    description: "Navigate to URL that redirects"

  - name: "check_redirect"
    action: "evaluate"
    script: |
      return {
        finalUrl: window.location.href,
        wasRedirected: !window.location.href.startsWith('http://'),
        protocol: window.location.protocol
      };
    description: "Verify redirect occurred"

  # ============================================
  # DYNAMIC CONTENT WAITING
  # ============================================
  - name: "navigate_dynamic_site"
    action: "navigate"
    url: "https://www.google.com"
    description: "Navigate to site with dynamic content"

  - name: "wait_for_search_box"
    action: "wait_for_selector"
    selector: "input[name='q']"
    timeout: 5000
    description: "Wait for specific element to appear"

  - name: "wait_for_custom_condition"
    action: "wait_for_function"
    function: |
      return document.querySelector('input[name="q"]') && 
             document.querySelector('input[name="q"]').offsetWidth > 0;
    timeout: 5000
    description: "Wait for custom condition (element visible)"

  # ============================================
  # ERROR HANDLING
  # ============================================
  - name: "navigate_with_error_handling"
    action: "navigate"
    url: "https://this-site-definitely-does-not-exist-12345.com"
    wait_until: "networkidle2"
    error_handler:
      - action: "log"
        message: "Navigation failed as expected - site doesn't exist"
      - action: "screenshot"
        path: "${context.outputDir}/error-page.png"
    description: "Demonstrate error handling for failed navigation"

  # ============================================
  # NAVIGATION WITH INTERACTIONS
  # ============================================
  - name: "navigate_and_interact"
    action: "navigate"
    url: "https://www.wikipedia.org"
    description: "Navigate to interactive site"

  - name: "click_link"
    action: "click"
    selector: "a[href*='wiki/']"
    wait_after: 2000
    description: "Click first wiki link"

  - name: "go_back"
    action: "go_back"
    wait_until: "networkidle2"
    description: "Navigate back in history"

  - name: "go_forward"
    action: "go_forward"
    wait_until: "networkidle2"
    description: "Navigate forward in history"

  # ============================================
  # MULTIPLE TABS/WINDOWS
  # ============================================
  - name: "open_new_tab"
    action: "evaluate"
    script: |
      window.open('https://example.org', '_blank');
      return { tabsOpen: true };
    description: "Open link in new tab"

  - name: "switch_to_new_tab"
    action: "switch_to_tab"
    index: 1
    description: "Switch to newly opened tab"

  - name: "close_tab"
    action: "close_tab"
    description: "Close current tab"

  - name: "switch_back"
    action: "switch_to_tab"
    index: 0
    description: "Switch back to original tab"

outputs:
  - screenshots:
      homepage: "${context.outputDir}/example-homepage.png"
      error_page: "${context.outputDir}/error-page.png"
  - navigation_data:
      redirect_info: "${steps.check_redirect.result}"
      final_url: "${steps.check_redirect.result.finalUrl}"
  - status: "Navigation examples completed successfully"