{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "NSFW Detector Configuration Schema",
  "type": "object",
  "properties": {
    "port": {
      "type": "integer",
      "description": "Service port number",
      "minimum": 1024,
      "maximum": 65535,
      "default": 11451
    },
    "model": {
      "type": "object",
      "properties": {
        "default": {
          "type": "string",
          "enum": [
            "nsfwjs",
            "safety-checker",
            "custom"
          ],
          "default": "nsfwjs"
        },
        "path": {
          "type": "string",
          "description": "Path to model files",
          "default": "/var/lib/nsfw-detector/models"
        },
        "cache_size": {
          "type": "integer",
          "description": "Number of models to keep in memory",
          "minimum": 1,
          "maximum": 10,
          "default": 3
        }
      }
    },
    "thresholds": {
      "type": "object",
      "properties": {
        "adult": {
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "default": 0.7
        },
        "racy": {
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "default": 0.6
        },
        "gore": {
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "default": 0.8
        },
        "violence": {
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "default": 0.8
        },
        "safe": {
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "default": 0.5
        }
      }
    },
    "performance": {
      "type": "object",
      "properties": {
        "max_batch_size": {
          "type": "integer",
          "minimum": 1,
          "maximum": 100,
          "default": 10
        },
        "timeout_ms": {
          "type": "integer",
          "minimum": 100,
          "maximum": 30000,
          "default": 5000
        },
        "max_image_size": {
          "type": "integer",
          "description": "Maximum image size in bytes",
          "default": 10485760
        },
        "cache_size": {
          "type": "integer",
          "description": "Number of results to cache",
          "default": 100
        },
        "worker_threads": {
          "type": "integer",
          "minimum": 1,
          "maximum": 16,
          "default": 4
        }
      }
    },
    "logging": {
      "type": "object",
      "properties": {
        "level": {
          "type": "string",
          "enum": [
            "debug",
            "info",
            "warn",
            "error"
          ],
          "default": "info"
        },
        "dir": {
          "type": "string",
          "default": "/var/log/nsfw-detector"
        },
        "audit": {
          "type": "boolean",
          "description": "Enable audit logging",
          "default": false
        }
      }
    },
    "security": {
      "type": "object",
      "properties": {
        "encrypt_models": {
          "type": "boolean",
          "default": false
        },
        "allowed_origins": {
          "type": "string",
          "default": "*"
        },
        "rate_limit": {
          "type": "integer",
          "description": "Requests per minute",
          "default": 100
        }
      }
    }
  },
  "required": [
    "port"
  ],
  "additionalProperties": false,
  "$id": "https://vrooli.com/resources/nsfw-detector/schema.json"
}
