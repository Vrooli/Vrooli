{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Open MCT Configuration Schema",
  "type": "object",
  "properties": {
    "port": {
      "type": "integer",
      "description": "HTTP port for Open MCT web interface",
      "minimum": 1024,
      "maximum": 65535,
      "default": 8099
    },
    "host": {
      "type": "string",
      "description": "Host interface to bind to",
      "default": "0.0.0.0"
    },
    "telemetry": {
      "type": "object",
      "properties": {
        "maxStreams": {
          "type": "integer",
          "description": "Maximum concurrent telemetry streams",
          "minimum": 1,
          "maximum": 1000,
          "default": 100
        },
        "historyDays": {
          "type": "integer",
          "description": "Days of historical data to retain",
          "minimum": 1,
          "maximum": 365,
          "default": 30
        },
        "sampleRate": {
          "type": "integer",
          "description": "Milliseconds between telemetry samples",
          "minimum": 100,
          "maximum": 60000,
          "default": 1000
        },
        "compressHistory": {
          "type": "boolean",
          "description": "Enable historical data compression",
          "default": true
        }
      }
    },
    "websocket": {
      "type": "object",
      "properties": {
        "port": {
          "type": "integer",
          "description": "WebSocket port for real-time telemetry",
          "minimum": 1024,
          "maximum": 65535
        },
        "bufferSize": {
          "type": "integer",
          "description": "WebSocket buffer size in bytes",
          "minimum": 1024,
          "maximum": 1048576,
          "default": 65536
        },
        "maxConnections": {
          "type": "integer",
          "description": "Maximum WebSocket connections",
          "minimum": 1,
          "maximum": 1000,
          "default": 100
        }
      }
    },
    "auth": {
      "type": "object",
      "properties": {
        "enabled": {
          "type": "boolean",
          "description": "Enable authentication",
          "default": false
        },
        "username": {
          "type": "string",
          "description": "Admin username",
          "default": "admin"
        },
        "password": {
          "type": "string",
          "description": "Admin password (set via environment variable)"
        }
      }
    },
    "demo": {
      "type": "object",
      "properties": {
        "enabled": {
          "type": "boolean",
          "description": "Enable demo telemetry streams",
          "default": true
        },
        "satellite": {
          "type": "boolean",
          "description": "Enable satellite telemetry demo",
          "default": true
        },
        "sensors": {
          "type": "boolean",
          "description": "Enable sensor network demo",
          "default": true
        },
        "metrics": {
          "type": "boolean",
          "description": "Enable system metrics demo",
          "default": true
        }
      }
    },
    "integrations": {
      "type": "object",
      "properties": {
        "mqtt": {
          "type": "object",
          "properties": {
            "enabled": {
              "type": "boolean",
              "default": false
            },
            "broker": {
              "type": "string",
              "description": "MQTT broker URL"
            },
            "topics": {
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          }
        },
        "traccar": {
          "type": "object",
          "properties": {
            "enabled": {
              "type": "boolean",
              "default": false
            },
            "url": {
              "type": "string",
              "description": "Traccar server URL"
            },
            "devices": {
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          }
        }
      }
    },
    "performance": {
      "type": "object",
      "properties": {
        "cacheEnabled": {
          "type": "boolean",
          "description": "Enable data caching",
          "default": true
        },
        "cacheTTL": {
          "type": "integer",
          "description": "Cache time-to-live in seconds",
          "minimum": 60,
          "maximum": 86400,
          "default": 3600
        },
        "dbWALMode": {
          "type": "boolean",
          "description": "Enable SQLite WAL mode for better concurrency",
          "default": true
        }
      }
    },
    "logging": {
      "type": "object",
      "properties": {
        "level": {
          "type": "string",
          "enum": [
            "debug",
            "info",
            "warn",
            "error"
          ],
          "default": "info"
        },
        "maxSize": {
          "type": "string",
          "description": "Maximum log file size",
          "default": "10M"
        },
        "maxFiles": {
          "type": "integer",
          "description": "Maximum number of log files to retain",
          "minimum": 1,
          "maximum": 100,
          "default": 5
        }
      }
    },
    "docker": {
      "type": "object",
      "properties": {
        "memoryLimit": {
          "type": "string",
          "description": "Docker memory limit",
          "default": "1g"
        },
        "cpuLimit": {
          "type": "number",
          "description": "Docker CPU limit",
          "minimum": 0.1,
          "maximum": 8,
          "default": 1.0
        },
        "restartPolicy": {
          "type": "string",
          "enum": [
            "no",
            "always",
            "on-failure",
            "unless-stopped"
          ],
          "default": "unless-stopped"
        }
      }
    }
  },
  "required": [
    "port"
  ],
  "additionalProperties": false,
  "$id": "https://vrooli.com/resources/openmct/schema.json"
}
