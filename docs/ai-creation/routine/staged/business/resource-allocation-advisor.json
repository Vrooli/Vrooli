{
  "id": "7829564732190847195",
  "publicId": "resource-alloc-v1",
  "resourceType": "Routine",
  "isPrivate": false,
  "permissions": "{}",
  "isInternal": false,
  "tags": [],
  "versions": [
    {
      "id": "7829564732190847196",
      "publicId": "allocation-v1",
      "versionLabel": "1.0.0",
      "versionNotes": "Initial version",
      "isComplete": true,
      "isPrivate": false,
      "versionIndex": 0,
      "isAutomatable": true,
      "resourceSubType": "RoutineCode",
      "config": {
        "__version": "1.0",
        "callDataCode": {
          "__version": "1.0",
          "schema": {
            "language": "python",
            "code": "import json\nimport datetime\nfrom itertools import combinations\n\ndef optimize_resource_allocation():\n    # Get inputs\n    project_list = globals().get('project_list', '')\n    resource_constraints = globals().get('resource_constraints', '')\n    priorities = globals().get('priorities', '')\n    deadlines = globals().get('deadlines', '')\n    allocation_method = globals().get('allocation_method', 'Balanced')\n    optimization_goal = globals().get('optimization_goal', 'Maximize value')\n    \n    def parse_projects(project_text):\n        \"\"\"Parse project list from input text\"\"\"\n        projects = []\n        if not project_text:\n            # Sample data for demonstration\n            return [\n                {'name': 'Website Redesign', 'priority': 8, 'effort': 120, 'value': 85, 'deadline': '2024-03-15'},\n                {'name': 'Mobile App', 'priority': 9, 'effort': 200, 'value': 95, 'deadline': '2024-04-30'},\n                {'name': 'Database Migration', 'priority': 7, 'effort': 80, 'value': 70, 'deadline': '2024-02-28'},\n                {'name': 'Marketing Campaign', 'priority': 6, 'effort': 60, 'value': 75, 'deadline': '2024-03-31'},\n                {'name': 'Security Audit', 'priority': 9, 'effort': 40, 'value': 90, 'deadline': '2024-02-15'}\n            ]\n        \n        lines = project_text.strip().split('\\n')\n        for line in lines:\n            if line.strip():\n                try:\n                    # Expected format: Project Name, Priority (1-10), Effort (hours), Value (1-100), Deadline\n                    parts = [p.strip() for p in line.split(',')]\n                    if len(parts) >= 4:\n                        project = {\n                            'name': parts[0],\n                            'priority': int(parts[1]) if parts[1].isdigit() else 5,\n                            'effort': int(parts[2]) if parts[2].isdigit() else 40,\n                            'value': int(parts[3]) if parts[3].isdigit() else 50,\n                            'deadline': parts[4] if len(parts) > 4 else '2024-06-30'\n                        }\n                        projects.append(project)\n                except:\n                    continue\n        \n        return projects if projects else [\n            {'name': 'Sample Project', 'priority': 5, 'effort': 40, 'value': 50, 'deadline': '2024-06-30'}\n        ]\n    \n    def parse_resources(resource_text):\n        \"\"\"Parse resource constraints\"\"\"\n        resources = {\n            'total_hours': 1000,\n            'team_size': 5,\n            'budget': 50000,\n            'time_weeks': 12,\n            'specialized_skills': [],\n            'availability_percent': 80\n        }\n        \n        if resource_text:\n            lines = resource_text.lower().split('\\n')\n            for line in lines:\n                if 'hours' in line or 'time' in line:\n                    numbers = [int(s) for s in line.split() if s.isdigit()]\n                    if numbers:\n                        resources['total_hours'] = numbers[0]\n                elif 'team' in line or 'people' in line:\n                    numbers = [int(s) for s in line.split() if s.isdigit()]\n                    if numbers:\n                        resources['team_size'] = numbers[0]\n                elif 'budget' in line or 'cost' in line:\n                    numbers = [int(s) for s in line.split() if s.isdigit()]\n                    if numbers:\n                        resources['budget'] = numbers[0]\n                elif 'week' in line:\n                    numbers = [int(s) for s in line.split() if s.isdigit()]\n                    if numbers:\n                        resources['time_weeks'] = numbers[0]\n        \n        return resources\n    \n    def calculate_project_scores(projects, method='balanced'):\n        \"\"\"Calculate allocation scores for projects\"\"\"\n        for project in projects:\n            # Basic efficiency score\n            efficiency = project['value'] / max(project['effort'], 1)\n            \n            # Priority weight\n            priority_weight = project['priority'] / 10.0\n            \n            # Deadline urgency (closer deadline = higher urgency)\n            try:\n                deadline_date = datetime.datetime.strptime(project['deadline'], '%Y-%m-%d')\n                today = datetime.datetime.now()\n                days_remaining = (deadline_date - today).days\n                urgency = max(0, (365 - days_remaining) / 365)  # Higher for closer deadlines\n            except:\n                urgency = 0.5  # Default urgency\n            \n            # Calculate composite score based on method\n            if method.lower() == 'value_focused':\n                score = project['value'] * 0.6 + priority_weight * 20 + urgency * 20\n            elif method.lower() == 'efficiency_focused':\n                score = efficiency * 40 + priority_weight * 20 + urgency * 20\n            elif method.lower() == 'deadline_focused':\n                score = urgency * 40 + priority_weight * 30 + project['value'] * 0.3\n            else:  # balanced\n                score = (efficiency * 25 + priority_weight * 25 + \n                        project['value'] * 0.25 + urgency * 25)\n            \n            project['score'] = round(score, 2)\n            project['efficiency'] = round(efficiency, 2)\n            project['urgency'] = round(urgency, 2)\n        \n        return projects\n    \n    def create_allocation_scenarios(projects, resources):\n        \"\"\"Create different allocation scenarios\"\"\"\n        scenarios = []\n        \n        # Scenario 1: Priority-based allocation\n        priority_projects = sorted(projects, key=lambda x: x['priority'], reverse=True)\n        priority_allocation = allocate_resources(priority_projects, resources, 'priority')\n        scenarios.append({\n            'name': 'Priority-Based Allocation',\n            'description': 'Allocate resources based on project priority rankings',\n            'allocation': priority_allocation,\n            'total_value': sum(p['value'] for p in priority_allocation['selected_projects']),\n            'total_effort': sum(p['effort'] for p in priority_allocation['selected_projects']),\n            'projects_completed': len(priority_allocation['selected_projects'])\n        })\n        \n        # Scenario 2: Value-optimized allocation\n        value_projects = sorted(projects, key=lambda x: x['value'], reverse=True)\n        value_allocation = allocate_resources(value_projects, resources, 'value')\n        scenarios.append({\n            'name': 'Value-Optimized Allocation',\n            'description': 'Maximize total business value delivered',\n            'allocation': value_allocation,\n            'total_value': sum(p['value'] for p in value_allocation['selected_projects']),\n            'total_effort': sum(p['effort'] for p in value_allocation['selected_projects']),\n            'projects_completed': len(value_allocation['selected_projects'])\n        })\n        \n        # Scenario 3: Efficiency-focused allocation\n        efficiency_projects = sorted(projects, key=lambda x: x['efficiency'], reverse=True)\n        efficiency_allocation = allocate_resources(efficiency_projects, resources, 'efficiency')\n        scenarios.append({\n            'name': 'Efficiency-Focused Allocation',\n            'description': 'Maximize value per hour invested',\n            'allocation': efficiency_allocation,\n            'total_value': sum(p['value'] for p in efficiency_allocation['selected_projects']),\n            'total_effort': sum(p['effort'] for p in efficiency_allocation['selected_projects']),\n            'projects_completed': len(efficiency_allocation['selected_projects'])\n        })\n        \n        # Scenario 4: Balanced allocation\n        balanced_projects = sorted(projects, key=lambda x: x['score'], reverse=True)\n        balanced_allocation = allocate_resources(balanced_projects, resources, 'balanced')\n        scenarios.append({\n            'name': 'Balanced Allocation',\n            'description': 'Balance priority, value, efficiency, and deadlines',\n            'allocation': balanced_allocation,\n            'total_value': sum(p['value'] for p in balanced_allocation['selected_projects']),\n            'total_effort': sum(p['effort'] for p in balanced_allocation['selected_projects']),\n            'projects_completed': len(balanced_allocation['selected_projects'])\n        })\n        \n        return scenarios\n    \n    def allocate_resources(projects, resources, method):\n        \"\"\"Allocate resources to projects using greedy algorithm\"\"\"\n        selected_projects = []\n        remaining_hours = resources['total_hours']\n        remaining_budget = resources['budget']\n        \n        for project in projects:\n            # Check if we have enough resources\n            estimated_cost = project['effort'] * 50  # Assume $50/hour\n            \n            if (project['effort'] <= remaining_hours and \n                estimated_cost <= remaining_budget):\n                \n                selected_projects.append(project.copy())\n                remaining_hours -= project['effort']\n                remaining_budget -= estimated_cost\n        \n        # Calculate utilization\n        utilization = {\n            'hours_used': resources['total_hours'] - remaining_hours,\n            'hours_remaining': remaining_hours,\n            'hours_utilization': ((resources['total_hours'] - remaining_hours) / resources['total_hours']) * 100,\n            'budget_used': resources['budget'] - remaining_budget,\n            'budget_remaining': remaining_budget,\n            'budget_utilization': ((resources['budget'] - remaining_budget) / resources['budget']) * 100\n        }\n        \n        return {\n            'selected_projects': selected_projects,\n            'deferred_projects': [p for p in projects if p not in selected_projects],\n            'utilization': utilization\n        }\n    \n    def analyze_trade_offs(scenarios):\n        \"\"\"Analyze trade-offs between scenarios\"\"\"\n        analysis = {\n            'best_value': max(scenarios, key=lambda x: x['total_value']),\n            'most_projects': max(scenarios, key=lambda x: x['projects_completed']),\n            'most_efficient': max(scenarios, key=lambda x: x['total_value'] / max(x['total_effort'], 1)),\n            'comparison_matrix': []\n        }\n        \n        # Create comparison matrix\n        for scenario in scenarios:\n            efficiency = scenario['total_value'] / max(scenario['total_effort'], 1)\n            analysis['comparison_matrix'].append({\n                'scenario': scenario['name'],\n                'total_value': scenario['total_value'],\n                'projects_completed': scenario['projects_completed'],\n                'total_effort': scenario['total_effort'],\n                'efficiency_ratio': round(efficiency, 2),\n                'resource_utilization': round(scenario['allocation']['utilization']['hours_utilization'], 1)\n            })\n        \n        return analysis\n    \n    def generate_recommendations(scenarios, trade_offs, optimization_goal):\n        \"\"\"Generate recommendations based on analysis\"\"\"\n        recommendations = []\n        \n        if optimization_goal.lower() == 'maximize value':\n            best_scenario = trade_offs['best_value']\n            recommendations.append({\n                'primary': f\"Recommend '{best_scenario['name']}' to maximize business value\",\n                'rationale': f\"Delivers {best_scenario['total_value']} total value points\",\n                'considerations': 'Ensure adequate resources for high-value projects'\n            })\n        elif optimization_goal.lower() == 'maximize efficiency':\n            best_scenario = trade_offs['most_efficient']\n            recommendations.append({\n                'primary': f\"Recommend '{best_scenario['name']}' for best efficiency\",\n                'rationale': f\"Highest value-to-effort ratio\",\n                'considerations': 'Focus on quick wins and high-impact projects'\n            })\n        else:\n            # Balanced approach\n            balanced_scenario = next((s for s in scenarios if 'balanced' in s['name'].lower()), scenarios[0])\n            recommendations.append({\n                'primary': f\"Recommend '{balanced_scenario['name']}' for balanced approach\",\n                'rationale': 'Balances multiple objectives effectively',\n                'considerations': 'Provides good balance of value, efficiency, and risk'\n            })\n        \n        # Additional recommendations\n        recommendations.extend([\n            {\n                'secondary': 'Monitor resource utilization regularly',\n                'rationale': 'Ensure optimal use of available resources',\n                'considerations': 'Adjust allocations based on actual progress'\n            },\n            {\n                'secondary': 'Consider phased implementation',\n                'rationale': 'Reduce risk and allow for course corrections',\n                'considerations': 'Start with highest-priority projects'\n            }\n        ])\n        \n        return recommendations\n    \n    # Main execution\n    try:\n        projects = parse_projects(project_list)\n        resources = parse_resources(resource_constraints)\n        \n        # Calculate project scores\n        projects_with_scores = calculate_project_scores(projects, allocation_method)\n        \n        # Create allocation scenarios\n        scenarios = create_allocation_scenarios(projects_with_scores, resources)\n        \n        # Analyze trade-offs\n        trade_offs = analyze_trade_offs(scenarios)\n        \n        # Generate recommendations\n        recommendations = generate_recommendations(scenarios, trade_offs, optimization_goal)\n        \n        # Create comprehensive output\n        output = {\n            'resource_allocation_analysis': {\n                'total_projects': len(projects),\n                'available_resources': resources,\n                'optimization_goal': optimization_goal,\n                'allocation_method': allocation_method\n            },\n            'project_analysis': {\n                'projects_with_scores': projects_with_scores,\n                'scoring_methodology': {\n                    'efficiency': 'Value divided by effort required',\n                    'priority_weight': 'Priority score (1-10) normalized',\n                    'urgency': 'Based on deadline proximity',\n                    'composite_score': f'Calculated using {allocation_method} method'\n                }\n            },\n            'allocation_scenarios': scenarios,\n            'trade_off_analysis': trade_offs,\n            'recommendations': recommendations,\n            'implementation_guidance': {\n                'immediate_actions': [\n                    'Review and validate project priorities',\n                    'Confirm resource availability and constraints',\n                    'Select preferred allocation scenario',\n                    'Communicate decisions to stakeholders'\n                ],\n                'monitoring_metrics': [\n                    'Resource utilization rates',\n                    'Project progress against timeline',\n                    'Value delivery milestones',\n                    'Budget consumption tracking'\n                ],\n                'risk_mitigation': [\n                    'Build buffer time into critical projects',\n                    'Identify resource substitution options',\n                    'Plan for scope adjustments if needed',\n                    'Regular review and reallocation checkpoints'\n                ]\n            },\n            'sensitivity_analysis': {\n                'resource_constraints': 'How allocation changes with Â±20% resource availability',\n                'priority_shifts': 'Impact of changing project priorities',\n                'deadline_pressure': 'Effect of compressed timelines',\n                'scope_flexibility': 'Options for project scope adjustments'\n            }\n        }\n        \n        return json.dumps(output, indent=2)\n        \n    except Exception as e:\n        return json.dumps({\n            'error': f'Error in resource allocation analysis: {str(e)}',\n            'basic_guidance': {\n                'step1': 'List all projects with effort estimates',\n                'step2': 'Define available resources clearly',\n                'step3': 'Prioritize projects based on value and urgency',\n                'step4': 'Allocate resources to highest-priority items first'\n            }\n        }, indent=2)\n\n# Execute the function\nresult = optimize_resource_allocation()\nprint(result)"
          }
        },
        "formInput": {
          "__version": "1.0",
          "schema": {
            "containers": [],
            "elements": [
              {
                "fieldName": "project_list",
                "id": "project_list_input",
                "label": "Project List",
                "type": "Text",
                "isRequired": false,
                "props": {
                  "placeholder": "List your projects (one per line): Project Name, Priority (1-10), Effort (hours), Value (1-100), Deadline (YYYY-MM-DD)\n\nExample:\nWebsite Redesign, 8, 120, 85, 2024-03-15\nMobile App, 9, 200, 95, 2024-04-30\n\nLeave blank to use sample data.",
                  "minRows": 6
                }
              },
              {
                "fieldName": "resource_constraints",
                "id": "resource_constraints_input",
                "label": "Resource Constraints",
                "type": "Text",
                "isRequired": true,
                "props": {
                  "placeholder": "Describe your resource constraints:\n- Total hours available\n- Team size\n- Budget\n- Time period (weeks)\n- Any special requirements or limitations",
                  "minRows": 4
                }
              },
              {
                "fieldName": "priorities",
                "id": "priorities_input",
                "label": "Priority Criteria",
                "type": "Text",
                "isRequired": true,
                "props": {
                  "placeholder": "What factors determine project priority? (business value, strategic alignment, customer impact, compliance, etc.)",
                  "minRows": 2
                }
              },
              {
                "fieldName": "deadlines",
                "id": "deadlines_input",
                "label": "Deadline Constraints",
                "type": "Text",
                "isRequired": false,
                "props": {
                  "placeholder": "Any critical deadlines or time constraints to consider?",
                  "minRows": 2
                }
              },
              {
                "fieldName": "allocation_method",
                "id": "allocation_method_input",
                "label": "Allocation Method",
                "type": "Selector",
                "isRequired": true,
                "props": {
                  "options": ["Balanced", "Value-focused", "Efficiency-focused", "Deadline-focused", "Priority-focused"],
                  "defaultValue": "Balanced"
                }
              },
              {
                "fieldName": "optimization_goal",
                "id": "optimization_goal_input",
                "label": "Optimization Goal",
                "type": "Selector",
                "isRequired": true,
                "props": {
                  "options": ["Maximize value", "Maximize efficiency", "Minimize risk", "Balance objectives", "Meet all deadlines"],
                  "defaultValue": "Maximize value"
                }
              },
              {
                "fieldName": "flexibilityLevel",
                "id": "flexibility_level_input",
                "label": "Flexibility Level",
                "type": "Selector",
                "isRequired": true,
                "props": {
                  "options": ["Fixed scope and timeline", "Some flexibility in scope", "Flexible timeline", "High flexibility", "Completely adaptable"],
                  "defaultValue": "Some flexibility in scope"
                }
              }
            ]
          }
        },
        "formOutput": {
          "__version": "1.0",
          "schema": {
            "containers": [],
            "elements": [
              {
                "fieldName": "response",
                "id": "complete_allocation_analysis_output",
                "label": "Complete Resource Allocation Analysis",
                "type": "Text"
              },
              {
                "fieldName": "allocationScenarios",
                "id": "allocation_scenarios_output",
                "label": "Allocation Scenarios & Comparisons",
                "type": "Text"
              },
              {
                "fieldName": "recommendations",
                "id": "recommendations_output",
                "label": "Recommendations & Rationale",
                "type": "Text"
              },
              {
                "fieldName": "implementationPlan",
                "id": "implementation_plan_output",
                "label": "Implementation Plan & Monitoring",
                "type": "Text"
              }
            ]
          }
        },
        "executionStrategy": "reasoning"
      },
      "translations": [
        {
          "id": "7829564732190847197",
          "language": "en",
          "name": "Resource Allocation Advisor",
          "description": "Helps distribute resources across projects optimally. Models different scenarios with trade-offs, provides allocation plans with scenario comparisons and implementation guidance.",
          "instructions": "1. List your projects with details (or use sample data)\n2. Describe resource constraints\n3. Define priority criteria\n4. Add deadline constraints (optional)\n5. Choose allocation method\n6. Set optimization goal\n7. Select flexibility level\n\nThe advisor will:\n- Analyze projects with scoring methodology\n- Create multiple allocation scenarios\n- Compare trade-offs between approaches\n- Provide recommendations with rationale\n- Generate implementation guidance\n- Include sensitivity analysis\n- Offer monitoring and risk mitigation strategies\n\nPerfect for project managers, executives, and teams who need to optimize resource distribution across multiple competing priorities."
        }
      ]
    }
  ]
}