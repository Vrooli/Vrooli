{
  "id": "7829564732190850184",
  "publicId": "study-allocate-v1",
  "resourceType": "Routine",
  "isPrivate": false,
  "permissions": "{}",
  "isInternal": false,
  "tags": [],
  "versions": [
    {
      "id": "7829564732190850185",
      "publicId": "study-allocate-v1-0",
      "versionLabel": "1.0.0",
      "versionNotes": "Initial version - Allocates study time across subjects optimally",
      "isComplete": true,
      "isPrivate": false,
      "versionIndex": 0,
      "isAutomatable": true,
      "resourceSubType": "RoutineCode",
      "config": {
        "__version": "1.0",
        "callDataCode": {
          "__version": "1.0",
          "schema": {
            "language": "javascript",
            "logic": "function allocateStudyTime({ studyRequirements, availableHours, priorityRanking }) {\n  // Parse inputs\n  const requirements = Array.isArray(studyRequirements) ? studyRequirements : \n                      [studyRequirements].filter(Boolean);\n  const capacity = Array.isArray(availableHours) ? availableHours : [availableHours];\n  const priorities = Array.isArray(priorityRanking) ? priorityRanking : [priorityRanking];\n  \n  // Calculate total available study time\n  const totalCapacity = capacity.reduce((sum, exam) => sum + (exam.studyHours || 0), 0);\n  \n  // Create subject-priority mapping\n  const subjectPriorities = {};\n  priorities.forEach(priority => {\n    if (priority.subject) {\n      subjectPriorities[priority.subject] = {\n        rank: priority.rank || priority.priority || 1,\n        weight: priority.weight || 1,\n        difficulty: priority.difficulty || 'medium',\n        importance: priority.importance || 'medium'\n      };\n    }\n  });\n  \n  // Calculate time allocation for each subject\n  const timeAllocation = requirements.map(req => {\n    const subject = req.subject || req.name;\n    const priority = subjectPriorities[subject] || { rank: 1, weight: 1, difficulty: 'medium' };\n    \n    // Base time requirement\n    const baseTime = req.estimatedHours || req.timeRequired || 20;\n    \n    // Apply difficulty multiplier\n    const difficultyMultiplier = {\n      'easy': 0.8,\n      'medium': 1.0,\n      'hard': 1.3,\n      'very-hard': 1.6\n    };\n    const adjustedTime = baseTime * (difficultyMultiplier[priority.difficulty] || 1.0);\n    \n    // Apply priority weight\n    const priorityMultiplier = {\n      1: 1.5,  // Highest priority\n      2: 1.2,\n      3: 1.0,  // Medium priority\n      4: 0.8,\n      5: 0.6   // Lowest priority\n    };\n    const finalTime = adjustedTime * (priorityMultiplier[priority.rank] || 1.0);\n    \n    return {\n      subject: subject,\n      baseHours: baseTime,\n      adjustedHours: Math.ceil(adjustedTime),\n      allocatedHours: Math.ceil(finalTime),\n      priority: priority.rank,\n      difficulty: priority.difficulty,\n      percentage: 0 // Will be calculated after normalization\n    };\n  });\n  \n  // Normalize to fit available capacity\n  const totalDemand = timeAllocation.reduce((sum, alloc) => sum + alloc.allocatedHours, 0);\n  const scalingFactor = totalCapacity / totalDemand;\n  \n  const normalizedAllocation = timeAllocation.map(alloc => {\n    const scaledHours = Math.floor(alloc.allocatedHours * scalingFactor);\n    const percentage = Math.round((scaledHours / totalCapacity) * 100);\n    \n    return {\n      ...alloc,\n      allocatedHours: scaledHours,\n      percentage: percentage,\n      hoursPerWeek: Math.ceil(scaledHours / 4), // Assuming 4-week average\n      hoursPerDay: Math.ceil(scaledHours / 28)  // Assuming 4 weeks * 7 days\n    };\n  });\n  \n  // Create subject schedule with distribution\n  const subjectSchedule = normalizedAllocation.map(alloc => {\n    const subject = alloc.subject;\n    const totalHours = alloc.allocatedHours;\n    \n    // Distribute hours across learning phases\n    const phases = {\n      initial: Math.ceil(totalHours * 0.4),      // 40% for initial learning\n      practice: Math.ceil(totalHours * 0.3),     // 30% for practice\n      review: Math.ceil(totalHours * 0.2),       // 20% for review\n      intensive: Math.ceil(totalHours * 0.1)     // 10% for intensive final prep\n    };\n    \n    // Create weekly breakdown\n    const weeklyPlan = [];\n    const weeksAvailable = 4; // Default 4-week plan\n    \n    for (let week = 1; week <= weeksAvailable; week++) {\n      let weekFocus, weekHours;\n      \n      if (week === 1) {\n        weekFocus = 'initial-learning';\n        weekHours = phases.initial;\n      } else if (week === 2) {\n        weekFocus = 'practice-application';\n        weekHours = phases.practice;\n      } else if (week === 3) {\n        weekFocus = 'review-consolidation';\n        weekHours = phases.review;\n      } else {\n        weekFocus = 'intensive-preparation';\n        weekHours = phases.intensive;\n      }\n      \n      weeklyPlan.push({\n        week: week,\n        focus: weekFocus,\n        hours: weekHours,\n        dailyTarget: Math.ceil(weekHours / 7),\n        activities: generateWeekActivities(weekFocus, subject)\n      });\n    }\n    \n    return {\n      subject: subject,\n      totalAllocatedHours: totalHours,\n      phases: phases,\n      weeklyPlan: weeklyPlan,\n      priority: alloc.priority,\n      studyIntensity: calculateIntensity(alloc)\n    };\n  });\n  \n  function generateWeekActivities(focus, subject) {\n    const activities = {\n      'initial-learning': [\n        'Read core material',\n        'Take notes and create summaries',\n        'Watch educational videos',\n        'Complete introductory exercises'\n      ],\n      'practice-application': [\n        'Solve practice problems',\n        'Complete assignments',\n        'Apply concepts to examples',\n        'Create mind maps or diagrams'\n      ],\n      'review-consolidation': [\n        'Review notes and summaries',\n        'Create flashcards',\n        'Explain concepts aloud',\n        'Take practice quizzes'\n      ],\n      'intensive-preparation': [\n        'Complete mock exams',\n        'Focus on weak areas',\n        'Final review of key concepts',\n        'Prepare exam strategy'\n      ]\n    };\n    \n    return activities[focus] || ['Study subject material'];\n  }\n  \n  function calculateIntensity(allocation) {\n    const hoursPerDay = allocation.hoursPerDay;\n    if (hoursPerDay >= 4) return 'intensive';\n    if (hoursPerDay >= 2) return 'moderate';\n    if (hoursPerDay >= 1) return 'standard';\n    return 'light';\n  }\n  \n  // Perform workload balance check\n  const balanceCheck = {\n    totalAllocatedHours: normalizedAllocation.reduce((sum, a) => sum + a.allocatedHours, 0),\n    averageHoursPerSubject: Math.round(totalCapacity / normalizedAllocation.length),\n    highIntensitySubjects: normalizedAllocation.filter(a => a.hoursPerDay >= 3).length,\n    priorityDistribution: {\n      high: normalizedAllocation.filter(a => a.priority <= 2).length,\n      medium: normalizedAllocation.filter(a => a.priority === 3).length,\n      low: normalizedAllocation.filter(a => a.priority >= 4).length\n    },\n    workloadWarnings: identifyWorkloadIssues(normalizedAllocation),\n    recommendations: generateBalanceRecommendations(normalizedAllocation)\n  };\n  \n  function identifyWorkloadIssues(allocations) {\n    const warnings = [];\n    \n    const dailyTotal = allocations.reduce((sum, a) => sum + a.hoursPerDay, 0);\n    if (dailyTotal > 8) {\n      warnings.push('Daily study load exceeds 8 hours - consider reducing scope or extending timeline');\n    }\n    \n    const intensiveSubjects = allocations.filter(a => a.hoursPerDay >= 3).length;\n    if (intensiveSubjects > 2) {\n      warnings.push('Too many intensive subjects - consider redistributing effort');\n    }\n    \n    const lowTimeSubjects = allocations.filter(a => a.allocatedHours < 10).length;\n    if (lowTimeSubjects > 0) {\n      warnings.push(`${lowTimeSubjects} subjects have very limited study time - may need more focus`);\n    }\n    \n    return warnings;\n  }\n  \n  function generateBalanceRecommendations(allocations) {\n    const recommendations = [];\n    \n    // Check for even distribution\n    const maxHours = Math.max(...allocations.map(a => a.allocatedHours));\n    const minHours = Math.min(...allocations.map(a => a.allocatedHours));\n    \n    if (maxHours / minHours > 3) {\n      recommendations.push('Consider more even time distribution across subjects');\n    }\n    \n    // Suggest study grouping\n    const similarSubjects = identifySimilarSubjects(allocations);\n    if (similarSubjects.length > 0) {\n      recommendations.push('Group similar subjects for efficient study sessions');\n    }\n    \n    return recommendations;\n  }\n  \n  function identifySimilarSubjects(allocations) {\n    // Simple similarity check based on subject names\n    const groups = [];\n    for (let i = 0; i < allocations.length - 1; i++) {\n      for (let j = i + 1; j < allocations.length; j++) {\n        const subj1 = allocations[i].subject.toLowerCase();\n        const subj2 = allocations[j].subject.toLowerCase();\n        \n        if (subj1.includes('math') && subj2.includes('math')) {\n          groups.push([allocations[i].subject, allocations[j].subject]);\n        }\n        // Add more similarity rules as needed\n      }\n    }\n    return groups;\n  }\n  \n  return {\n    timeAllocation: normalizedAllocation,\n    subjectSchedule: subjectSchedule,\n    balanceCheck: balanceCheck\n  };\n}"
          }
        },
        "formInput": {
          "__version": "1.0",
          "schema": {
            "containers": [],
            "elements": [
              {
                "fieldName": "studyRequirements",
                "id": "study_requirements_input",
                "label": "Learning Needs",
                "type": "JSON",
                "isRequired": true,
                "props": {
                  "placeholder": "Study requirements for each subject"
                }
              },
              {
                "fieldName": "availableHours",
                "id": "available_hours_input",
                "label": "Study Capacity",
                "type": "JSON",
                "isRequired": true,
                "props": {
                  "placeholder": "Available study time"
                }
              },
              {
                "fieldName": "priorityRanking",
                "id": "priority_ranking_input",
                "label": "Subject Priorities",
                "type": "JSON",
                "isRequired": true,
                "props": {
                  "placeholder": "Priority ranking for subjects"
                }
              }
            ]
          }
        },
        "formOutput": {
          "__version": "1.0",
          "schema": {
            "containers": [],
            "elements": [
              {
                "fieldName": "timeAllocation",
                "id": "time_allocation_output",
                "label": "Study Distribution",
                "type": "JSON"
              },
              {
                "fieldName": "subjectSchedule",
                "id": "subject_schedule_output",
                "label": "Topic Planning",
                "type": "JSON"
              },
              {
                "fieldName": "balanceCheck",
                "id": "balance_check_output",
                "label": "Workload Analysis",
                "type": "JSON"
              }
            ]
          }
        },
        "executionStrategy": "deterministic"
      },
      "translations": [
        {
          "id": "7829564732190850186",
          "language": "en",
          "name": "Study Time Allocator",
          "description": "Distributes study hours across subjects optimally based on priority, difficulty, and available time.",
          "instructions": "Provide study requirements, available hours, and priority rankings. The routine will allocate time optimally across subjects."
        }
      ]
    }
  ]
}