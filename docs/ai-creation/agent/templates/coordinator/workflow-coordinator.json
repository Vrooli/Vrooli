{
    "identity": {
        "name": "workflow-coordinator",
        "version": "1.0.0"
    },
    "goal": "Orchestrate complex multi-step workflows across specialist agents in the swarm",
    "role": "coordinator",
    "subscriptions": [
        "swarm/goal/created",
        "run/completed",
        "run/failed",
        "swarm/team/updated"
    ],
    "behaviors": [
        {
            "trigger": {
                "topic": "swarm/goal/created"
            },
            "action": {
                "type": "routine",
                "label": "Task Decomposer",
                "inputMap": {
                    "goalDescription": "event.data.description",
                    "goalId": "event.data.goalId",
                    "existingTasks": "subtasks.length",
                    "currentWorkload": "blackboard.workflows.active"
                },
                "outputOperations": {
                    "append": [
                        {
                            "routineOutput": "tasks",
                            "blackboardId": "workflow_tasks"
                        }
                    ],
                    "set": [
                        {
                            "routineOutput": "decomposition.strategy",
                            "blackboardId": "current_strategy"
                        }
                    ],
                    "increment": [
                        {
                            "routineOutput": "metadata.taskCount",
                            "blackboardId": "total_tasks_created"
                        }
                    ]
                }
            },
            "qos": 1
        },
        {
            "trigger": {
                "topic": "run/completed"
            },
            "action": {
                "type": "invoke",
                "purpose": "Analyze completed run outputs and determine next workflow step"
            },
            "qos": 1
        },
        {
            "trigger": {
                "topic": "run/failed"
            },
            "action": {
                "type": "routine",
                "label": "Error Recovery Planner",
                "inputMap": {
                    "error": "event.data.error",
                    "runId": "event.data.runId",
                    "totalTasks": "blackboard.total_tasks_created",
                    "currentStrategy": "blackboard.current_strategy"
                },
                "outputOperations": {
                    "append": [
                        {
                            "routineOutput": "recovery.actions",
                            "blackboardId": "recovery_history"
                        }
                    ],
                    "merge": [
                        {
                            "routineOutput": "metrics",
                            "blackboardId": "workflow_metrics"
                        }
                    ]
                }
            },
            "qos": 2
        }
    ],
    "prompt": {
        "mode": "supplement",
        "source": "direct",
        "content": "You must continuously monitor goal progress and coordinate task distribution. Never exceed allocated resources or create workflows that would overwhelm the system."
    },
    "resources": [
        {
            "type": "blackboard",
            "label": "task-coordination",
            "permissions": [
                "read",
                "write"
            ],
            "scope": "workflows.*",
            "description": "Read and write workflow states and task assignments"
        },
        {
            "type": "blackboard",
            "label": "agent-registry",
            "permissions": [
                "read"
            ],
            "scope": "agents.capabilities",
            "description": "Read available agents and their current capabilities"
        },
        {
            "type": "blackboard",
            "label": "performance-metrics",
            "permissions": [
                "read"
            ],
            "scope": "workflows.performance",
            "description": "Read workflow performance data for optimization"
        }
    ]
}