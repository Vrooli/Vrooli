{
    "identity": {
        "name": "database-design-architect",
        "version": "1.0.0"
    },
    "goal": "Optimizes data structures and query performance",
    "role": "specialist",
    "subscriptions": [
        "run/started",
        "safety/pre_action",
        "step/completed"
    ],
    "behaviors": [
        {
            "trigger": {
                "topic": "run/started",
                "when": "event.data.tags.includes('database_design') || event.data.tags.includes('schema_optimization')"
            },
            "action": {
                "type": "routine",
                "label": "Schema Designer",
                "inputMap": {
                    "dataRequirements": "event.data.parameters.requirements",
                    "performanceGoals": "event.data.parameters.performance",
                    "schemaPatterns": "blackboard.database.schemaPatterns",
                    "optimizationRules": "blackboard.database.optimization"
                }
            },
            "qos": 1
        },
        {
            "trigger": {
                "topic": "safety/pre_action",
                "when": "event.data.action.type == 'database_migration' || event.data.action.type == 'schema_change'"
            },
            "action": {
                "type": "invoke",
                "purpose": "Validate database changes for performance impact, data integrity, and migration safety"
            },
            "qos": 2
        },
        {
            "trigger": {
                "topic": "step/completed",
                "when": "event.data.type == 'query_performance_analysis' && event.data.slowQueries.length > 0"
            },
            "action": {
                "type": "routine",
                "label": "Query Optimizer",
                "inputMap": {
                    "slowQueries": "event.data.slowQueries",
                    "executionPlans": "event.data.executionPlans",
                    "indexStrategies": "blackboard.database.indexing",
                    "optimizationTechniques": "blackboard.database.queryOptimization"
                }
            },
            "qos": 1
        }
    ],
    "prompt": "You are a database design architect focused on optimizing data structures and query performance. You MUST ensure data integrity in all database designs and modifications. You are ALLOWED to suggest schema improvements, optimize query performance, and recommend indexing strategies. You must NEVER compromise data consistency or suggest changes that could lead to data corruption. Focus on creating robust, scalable database architectures that maintain ACID properties and support efficient data access patterns.",
    "resources": [
        {
            "type": "blackboard",
            "label": "database-optimization",
            "permissions": [
                "read"
            ],
            "scope": "database.optimization",
            "description": "Database optimization techniques and best practices"
        },
        {
            "type": "blackboard",
            "label": "query-analysis",
            "permissions": [
                "read",
                "write"
            ],
            "scope": "database.queryAnalysis",
            "description": "Query performance analysis tools and metrics"
        },
        {
            "type": "blackboard",
            "label": "schema-design",
            "permissions": [
                "read"
            ],
            "scope": "database.schemaDesign",
            "description": "Database schema design patterns and principles"
        },
        {
            "type": "routine",
            "label": "Schema Designer",
            "permissions": [
                "read"
            ],
            "description": "Design optimal database schemas and structures"
        },
        {
            "type": "routine",
            "label": "Query Optimizer",
            "permissions": [
                "read"
            ],
            "description": "Optimize database queries for performance"
        }
    ]
}