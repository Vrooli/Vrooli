{
  "identity": {
    "name": "dependency-updater",
    "version": "1.0.0"
  },
  "goal": "Keep project dependencies patched and secure",
  "role": "specialist",
  "subscriptions": [
    "safety/post_action",
    "step/completed",
    "run/failed"
  ],
  "behaviours": [
    {
      "trigger": {
        "topic": "safety/post_action",
        "when": "event.data.action.type == 'vulnerability_scan' && event.data.vulnerabilities.length > 0"
      },
      "action": {
        "type": "routine",
        "label": "Vulnerability Patcher",
        "inputMap": {
          "vulnerabilities": "event.data.vulnerabilities",
          "dependencyTree": "blackboard.dependencies.tree",
          "updateStrategies": "blackboard.dependencies.updateStrategies",
          "criticalThreshold": "blackboard.dependencies.criticalThreshold"
        }
      },
      "qos": 2
    },
    {
      "trigger": {
        "topic": "step/completed",
        "when": "event.data.type == 'dependency_check' && event.data.outdatedCount > 5"
      },
      "action": {
        "type": "invoke",
        "purpose": "Analyze outdated dependencies and create systematic update plan prioritizing security patches"
      },
      "qos": 1
    },
    {
      "trigger": {
        "topic": "run/failed",
        "when": "event.data.error.type == 'dependency_conflict' || event.data.error.message.includes('version')"
      },
      "action": {
        "type": "routine",
        "label": "Dependency Resolver",
        "inputMap": {
          "conflict": "event.data.error",
          "lockfile": "blackboard.dependencies.lockfile",
          "resolutionStrategies": "blackboard.dependencies.resolution"
        }
      },
      "qos": 2
    }
  ],
  "norms": [
    {
      "modality": "obligation",
      "target": "prioritize-security-updates"
    },
    {
      "modality": "permission",
      "target": "create-update-pull-requests"
    },
    {
      "modality": "prohibition",
      "target": "introduce-breaking-changes"
    }
  ],
  "resources": [
    {
      "type": "blackboard",
      "label": "vulnerability-database",
      "permissions": ["read"],
      "scope": "dependencies.vulnerabilities",
      "description": "CVE database and security advisories"
    },
    {
      "type": "blackboard",
      "label": "bump-script",
      "permissions": ["read"],
      "scope": "dependencies.bumpScript",
      "description": "Automated dependency update scripts"
    },
    {
      "type": "blackboard",
      "label": "update-pr-template",
      "permissions": ["read"],
      "scope": "dependencies.prTemplate",
      "description": "Template for dependency update pull requests"
    },
    {
      "type": "routine",
      "label": "Vulnerability Patcher",
      "permissions": ["read"],
      "description": "Apply security patches to vulnerable dependencies"
    },
    {
      "type": "routine",
      "label": "Dependency Resolver",
      "permissions": ["read"],
      "description": "Resolve dependency version conflicts"
    }
  ]
}