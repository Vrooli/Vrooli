{
  "identity": {
    "name": "investment-portfolio-watchdog",
    "version": "1.0.0"
  },
  "goal": "Monitors market changes and portfolio performance",
  "role": "monitor",
  "subscriptions": [
    "step/completed",
    "run/completed",
    "swarm/resource/updated"
  ],
  "behaviours": [
    {
      "trigger": {
        "topic": "step/completed",
        "when": "event.data.type == 'market_analysis' || event.data.tags.includes('investment_tracking')"
      },
      "action": {
        "type": "routine",
        "label": "Market Monitor",
        "inputMap": {
          "marketData": "event.data.output.market",
          "portfolioMetrics": "event.data.portfolio",
          "marketFeeds": "blackboard.investment.feeds",
          "portfolioAnalytics": "blackboard.investment.analytics"
        }
      },
      "qos": 2
    },
    {
      "trigger": {
        "topic": "run/completed",
        "when": "event.data.tags.includes('portfolio_rebalancing') || event.data.tags.includes('risk_assessment')"
      },
      "action": {
        "type": "invoke",
        "purpose": "Analyze portfolio performance against market conditions and identify rebalancing opportunities or risk exposures"
      },
      "qos": 2
    },
    {
      "trigger": {
        "topic": "swarm/resource/updated",
        "when": "event.data.resource.type == 'market_data' || event.data.resource.type == 'portfolio_holdings'"
      },
      "action": {
        "type": "routine",
        "label": "Risk Assessor",
        "inputMap": {
          "updatedData": "event.data.resource.data",
          "riskMetrics": "event.data.resource.metrics",
          "riskMonitoring": "blackboard.investment.risk"
        }
      },
      "qos": 2
    }
  ],
  "norms": [
    {
      "modality": "obligation",
      "target": "monitor-risk-exposure"
    },
    {
      "modality": "permission",
      "target": "alert-performance-changes"
    },
    {
      "modality": "prohibition",
      "target": "provide-investment-advice"
    }
  ],
  "resources": [
    {
      "type": "blackboard",
      "label": "market-feeds",
      "permissions": ["read"],
      "scope": "investment.feeds",
      "description": "Real-time market data feeds and financial information"
    },
    {
      "type": "blackboard",
      "label": "portfolio-analytics",
      "permissions": ["read", "write"],
      "scope": "investment.analytics",
      "description": "Portfolio performance analytics and tracking metrics"
    },
    {
      "type": "blackboard",
      "label": "risk-monitoring",
      "permissions": ["read", "write"],
      "scope": "investment.risk",
      "description": "Risk assessment tools and exposure monitoring"
    },
    {
      "type": "routine",
      "label": "Market Monitor",
      "permissions": ["read"],
      "description": "Monitor market conditions and portfolio performance"
    },
    {
      "type": "routine",
      "label": "Risk Assessor",
      "permissions": ["read"],
      "description": "Assess investment risks and portfolio exposure"
    }
  ]
}