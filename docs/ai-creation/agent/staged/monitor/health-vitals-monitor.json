{
  "identity": {
    "name": "health-vitals-monitor",
    "version": "1.0.0"
  },
  "goal": "Watches health metrics and suggests interventions",
  "role": "monitor",
  "subscriptions": [
    "step/completed",
    "run/completed",
    "safety/post_action"
  ],
  "behaviours": [
    {
      "trigger": {
        "topic": "step/completed",
        "when": "event.data.tags.includes('health_data') || event.data.type == 'vital_measurement'"
      },
      "action": {
        "type": "routine",
        "label": "Vitals Analyzer",
        "inputMap": {
          "measurement": "event.data.measurement",
          "vitalType": "event.data.vitalType",
          "normalRanges": "blackboard.health.normalRanges",
          "trendHistory": "blackboard.health.trends"
        }
      },
      "qos": 1
    },
    {
      "trigger": {
        "topic": "run/completed",
        "when": "event.data.tags.includes('health_assessment')"
      },
      "action": {
        "type": "invoke",
        "purpose": "Analyze comprehensive health data to identify concerning trends and suggest preventive interventions"
      },
      "qos": 1
    },
    {
      "trigger": {
        "topic": "safety/post_action",
        "when": "event.data.output.healthScore < blackboard.health.thresholds.critical"
      },
      "action": {
        "type": "routine",
        "label": "Health Alert Generator",
        "inputMap": {
          "healthScore": "event.data.output.healthScore",
          "riskFactors": "event.data.output.riskFactors",
          "interventionProtocols": "blackboard.health.interventions",
          "emergencyContacts": "blackboard.health.emergencyContacts"
        }
      },
      "qos": 2
    }
  ],
  "norms": [
    {
      "modality": "obligation",
      "target": "track-all-vitals"
    },
    {
      "modality": "permission",
      "target": "suggest-interventions"
    },
    {
      "modality": "prohibition",
      "target": "provide-medical-diagnoses"
    }
  ],
  "resources": [
    {
      "type": "blackboard",
      "label": "health-sensors",
      "permissions": ["read"],
      "scope": "health.sensors",
      "description": "Health monitoring devices and sensor data"
    },
    {
      "type": "blackboard",
      "label": "vital-thresholds",
      "permissions": ["read"],
      "scope": "health.thresholds",
      "description": "Normal ranges and alert thresholds for health vitals"
    },
    {
      "type": "blackboard",
      "label": "intervention-protocols",
      "permissions": ["read"],
      "scope": "health.interventions",
      "description": "Health intervention protocols and recommendations"
    },
    {
      "type": "routine",
      "label": "Vitals Analyzer",
      "permissions": ["read"],
      "description": "Analyze health vitals and identify concerning patterns"
    },
    {
      "type": "routine",
      "label": "Health Alert Generator",
      "permissions": ["read"],
      "description": "Generate health alerts for critical conditions"
    }
  ]
}