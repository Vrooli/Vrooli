{
    "identity": {
        "name": "fraud-detection-sentinel",
        "version": "1.0.0"
    },
    "goal": "Monitors for suspicious activities and anomalies",
    "role": "monitor",
    "subscriptions": [
        "safety/post_action",
        "step/completed",
        "run/failed"
    ],
    "behaviors": [
        {
            "trigger": {
                "topic": "safety/post_action",
                "when": "event.data.action.type == 'financial_transaction' || event.data.action.type == 'data_access'"
            },
            "action": {
                "type": "routine",
                "label": "Anomaly Detector",
                "inputMap": {
                    "action": "event.data.action",
                    "userProfile": "event.data.context.user",
                    "patterns": "blackboard.fraud.patterns",
                    "baseline": "blackboard.fraud.baseline"
                }
            },
            "qos": 2
        },
        {
            "trigger": {
                "topic": "step/completed",
                "when": "event.data.riskScore > blackboard.fraud.thresholds.suspicious"
            },
            "action": {
                "type": "invoke",
                "purpose": "Analyze high-risk activities for potential fraud indicators and correlate with known attack patterns"
            },
            "qos": 2
        },
        {
            "trigger": {
                "topic": "run/failed",
                "when": "event.data.error.type == 'authentication_failure' && event.data.retryCount > 3"
            },
            "action": {
                "type": "routine",
                "label": "Security Alert Generator",
                "inputMap": {
                    "failurePattern": "event.data.error",
                    "source": "event.data.context.source",
                    "alertThresholds": "blackboard.fraud.alertThresholds",
                    "incidentResponse": "blackboard.security.incidentResponse"
                }
            },
            "qos": 2
        }
    ],
    "prompt": {
        "mode": "supplement",
        "source": "direct",
        "content": "You must monitor all transactions and escalate confirmed fraud. You are permitted to freeze suspicious accounts."
    },
    "resources": [
        {
            "type": "blackboard",
            "label": "fraud-detection",
            "permissions": [
                "read",
                "write"
            ],
            "scope": "fraud.detection",
            "description": "Fraud detection algorithms and scoring systems"
        },
        {
            "type": "blackboard",
            "label": "anomaly-analysis",
            "permissions": [
                "read"
            ],
            "scope": "fraud.anomalyAnalysis",
            "description": "Anomaly detection models and baselines"
        },
        {
            "type": "blackboard",
            "label": "security-monitoring",
            "permissions": [
                "read",
                "write"
            ],
            "scope": "security.monitoring",
            "description": "Security monitoring and alerting systems"
        },
        {
            "type": "routine",
            "label": "Anomaly Detector",
            "permissions": [
                "read"
            ],
            "description": "Detect anomalous patterns in user behavior"
        },
        {
            "type": "routine",
            "label": "Security Alert Generator",
            "permissions": [
                "read"
            ],
            "description": "Generate security alerts for suspicious activities"
        }
    ]
}