{
    "identity": {
        "name": "technical-debt-monitor",
        "version": "1.0.0"
    },
    "goal": "Tracks code quality and maintenance needs",
    "role": "monitor",
    "subscriptions": [
        "step/completed",
        "run/completed",
        "safety/post_action"
    ],
    "behaviors": [
        {
            "trigger": {
                "topic": "step/completed",
                "when": "event.data.type == 'code_modification' || event.data.tags.includes('refactor')"
            },
            "action": {
                "type": "routine",
                "label": "Debt Analyzer",
                "inputMap": {
                    "codeChanges": "event.data.changes",
                    "complexity": "event.data.complexity",
                    "debtMetrics": "blackboard.debt.metrics",
                    "qualityThresholds": "blackboard.debt.thresholds"
                }
            },
            "qos": 0
        },
        {
            "trigger": {
                "topic": "run/completed",
                "when": "event.data.tags.includes('development')"
            },
            "action": {
                "type": "invoke",
                "purpose": "Analyze development run outcomes for technical debt accumulation and maintenance requirements"
            },
            "qos": 1
        },
        {
            "trigger": {
                "topic": "safety/post_action",
                "when": "event.data.action.type == 'code_deployment' && blackboard.debt.score > blackboard.debt.thresholds.critical"
            },
            "action": {
                "type": "routine",
                "label": "Maintenance Alert",
                "inputMap": {
                    "debtScore": "blackboard.debt.score",
                    "criticalAreas": "blackboard.debt.criticalAreas",
                    "maintenancePlan": "blackboard.debt.maintenancePlan"
                }
            },
            "qos": 2
        }
    ],
    "prompt": "You are a technical debt monitor. You must track code quality at all times. You may suggest refactoring opportunities when beneficial. You must never ignore critical debt issues that could compromise system stability.",
    "resources": [
        {
            "type": "blackboard",
            "label": "code-analysis",
            "permissions": [
                "read"
            ],
            "scope": "debt.codeAnalysis",
            "description": "Code analysis tools and quality metrics"
        },
        {
            "type": "blackboard",
            "label": "quality-metrics",
            "permissions": [
                "read",
                "write"
            ],
            "scope": "debt.metrics",
            "description": "Technical debt and quality metrics tracking"
        },
        {
            "type": "blackboard",
            "label": "debt-tracking",
            "permissions": [
                "read",
                "write"
            ],
            "scope": "debt.tracking",
            "description": "Technical debt accumulation and trend tracking"
        },
        {
            "type": "routine",
            "label": "Debt Analyzer",
            "permissions": [
                "read"
            ],
            "description": "Analyze code changes for technical debt impact"
        },
        {
            "type": "routine",
            "label": "Maintenance Alert",
            "permissions": [
                "read"
            ],
            "description": "Generate alerts for critical technical debt"
        }
    ]
}